Return-Path: <tipc-discussion-bounces@lists.sourceforge.net>
X-Original-To: lists+tipc-discussion@lfdr.de
Delivered-To: lists+tipc-discussion@lfdr.de
Received: from lists.sourceforge.net (lists.sourceforge.net [216.105.38.7])
	by mail.lfdr.de (Postfix) with ESMTPS id 11AFB226E2D
	for <lists+tipc-discussion@lfdr.de>; Mon, 20 Jul 2020 20:23:19 +0200 (CEST)
Received: from [127.0.0.1] (helo=sfs-ml-4.v29.lw.sourceforge.com)
	by sfs-ml-4.v29.lw.sourceforge.com with esmtp (Exim 4.90_1)
	(envelope-from <tipc-discussion-bounces@lists.sourceforge.net>)
	id 1jxaRU-000328-VM; Mon, 20 Jul 2020 18:23:12 +0000
Received: from [172.30.20.202] (helo=mx.sourceforge.net)
 by sfs-ml-4.v29.lw.sourceforge.com with esmtps
 (TLSv1.2:ECDHE-RSA-AES256-GCM-SHA384:256) (Exim 4.90_1)
 (envelope-from <jmaloy@redhat.com>) id 1jxaRT-00031z-Aw
 for tipc-discussion@lists.sourceforge.net; Mon, 20 Jul 2020 18:23:11 +0000
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
 d=sourceforge.net; s=x; h=Content-Transfer-Encoding:Content-Type:In-Reply-To:
 MIME-Version:Date:Message-ID:From:References:Cc:To:Subject:Sender:Reply-To:
 Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:
 Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:
 List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=0HH1166CXbL//karIalAR6LHEvA79RtC5FR16nt749A=; b=k2aflsYigvO2F0wob1GvQQ2Nng
 kuackKgE43v5+LTtNl62Zy8mZsKYPD9gjyFuxcldJwiKwgYt5M6bO1shUjdW/0pHNjdZlsf1ZPous
 EIMMvvNOpPZWkyjCIy/8WXD7MoGxhbsHKWJFfWkMjZuWBicA17bi+5yDzpNi1fZa0qdk=;
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=sf.net; s=x
 ;
 h=Content-Transfer-Encoding:Content-Type:In-Reply-To:MIME-Version:Date:
 Message-ID:From:References:Cc:To:Subject:Sender:Reply-To:Content-ID:
 Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc
 :Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:List-Subscribe:
 List-Post:List-Owner:List-Archive;
 bh=0HH1166CXbL//karIalAR6LHEvA79RtC5FR16nt749A=; b=VQCnjlobpGa70MemTERA+7fNoC
 c+nzhjiXRGc3hPql0t8IZIEtHlvkfCAtBTUqRhHaJsel8aJXVlOlOCf8YmcA74/UidXOp8JAM2ghz
 mEGfgLmZNGzGEaoEtIL3CuMpfDyLf8Abqgck9oQerd4Mx0IBq7ldVOsFHVxJcvcufJTg=;
Received: from us-smtp-1.mimecast.com ([207.211.31.81]
 helo=us-smtp-delivery-1.mimecast.com)
 by sfi-mx-3.v28.lw.sourceforge.com with esmtps
 (TLSv1.2:ECDHE-RSA-AES256-SHA384:256) (Exim 4.92.2)
 id 1jxaRN-00B8ON-PB
 for tipc-discussion@lists.sourceforge.net; Mon, 20 Jul 2020 18:23:11 +0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1595269379;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=0HH1166CXbL//karIalAR6LHEvA79RtC5FR16nt749A=;
 b=ZqSb1FXPwIJp7KBXMc+0/TG0JO51fEJO7xCODyuWrNos/v+bO0VXKtTYaMmC2NZEQfcn6q
 E7KKEqeQFmejaUCY/mvAfHlkEO7Xqmn/YuYnQb4CCFKgxPRu1wSf2fuHabjOupqh5EYy5x
 FDLaqGtr+X/JUyyvLno3qscobnZyyWw=
Received: from mimecast-mx01.redhat.com (mimecast-mx01.redhat.com
 [209.132.183.4]) (Using TLS) by relay.mimecast.com with ESMTP id
 us-mta-133-0FqgQXX9MdqSXO4NTAmH6w-1; Mon, 20 Jul 2020 14:22:55 -0400
X-MC-Unique: 0FqgQXX9MdqSXO4NTAmH6w-1
Received: from smtp.corp.redhat.com (int-mx08.intmail.prod.int.phx2.redhat.com
 [10.5.11.23])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by mimecast-mx01.redhat.com (Postfix) with ESMTPS id 12606100CCC0;
 Mon, 20 Jul 2020 18:22:54 +0000 (UTC)
Received: from [10.10.112.227] (ovpn-112-227.rdu2.redhat.com [10.10.112.227])
 by smtp.corp.redhat.com (Postfix) with ESMTP id 411442B5BF;
 Mon, 20 Jul 2020 18:22:53 +0000 (UTC)
To: Tuong Lien <tuong.t.lien@dektech.com.au>, maloy@donjonn.com,
 ying.xue@windriver.com, tipc-discussion@lists.sourceforge.net
References: <20200710101128.19713-1-tuong.t.lien@dektech.com.au>
 <20200710101128.19713-5-tuong.t.lien@dektech.com.au>
From: Jon Maloy <jmaloy@redhat.com>
Message-ID: <1dbd8369-4c55-46a6-0e22-89523e2adca8@redhat.com>
Date: Mon, 20 Jul 2020 14:22:52 -0400
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.6.0
MIME-Version: 1.0
In-Reply-To: <20200710101128.19713-5-tuong.t.lien@dektech.com.au>
Content-Language: en-US
X-Scanned-By: MIMEDefang 2.84 on 10.5.11.23
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
X-Spam-Score: 0.1 (/)
X-Spam-Report: Spam Filtering performed by mx.sourceforge.net.
 See http://spamassassin.org/tag/ for more details.
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/, no
 trust [207.211.31.81 listed in list.dnswl.org]
 0.0 RCVD_IN_MSPIKE_H3      RBL: Good reputation (+3)
 [207.211.31.81 listed in wl.mailspike.net]
 -0.0 SPF_PASS               SPF: sender matches SPF record
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.1 DKIM_VALID_AU Message has a valid DKIM or DK signature from author's
 domain
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature,
 not necessarily valid
 0.0 RCVD_IN_MSPIKE_WL      Mailspike good senders
 -0.0 NICE_REPLY_A           Looks like a legit reply (A)
 -0.0 DKIMWL_WL_HIGH         DKIMwl.org - Whitelisted High sender
 0.2 AWL AWL: Adjusted score from AWL reputation of From: address
X-Headers-End: 1jxaRN-00B8ON-PB
Subject: Re: [tipc-discussion] [PATCH RFC 4/5] tipc: add automatic session
 key exchange
X-BeenThere: tipc-discussion@lists.sourceforge.net
X-Mailman-Version: 2.1.21
Precedence: list
List-Id: <tipc-discussion.lists.sourceforge.net>
List-Unsubscribe: <https://lists.sourceforge.net/lists/options/tipc-discussion>, 
 <mailto:tipc-discussion-request@lists.sourceforge.net?subject=unsubscribe>
List-Archive: <http://sourceforge.net/mailarchive/forum.php?forum_name=tipc-discussion>
List-Post: <mailto:tipc-discussion@lists.sourceforge.net>
List-Help: <mailto:tipc-discussion-request@lists.sourceforge.net?subject=help>
List-Subscribe: <https://lists.sourceforge.net/lists/listinfo/tipc-discussion>, 
 <mailto:tipc-discussion-request@lists.sourceforge.net?subject=subscribe>
Cc: tipc-dek@dektech.com.au
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: tipc-discussion-bounces@lists.sourceforge.net

CgpPbiA3LzEwLzIwIDY6MTEgQU0sIFR1b25nIExpZW4gd3JvdGU6Cj4gV2l0aCBzdXBwb3J0IGZy
b20gdGhlIG1hc3RlciBrZXkgb3B0aW9uIGluIHRoZSBwcmV2aW91cyBjb21taXQsCml0IGJlY29t
ZXMgZWFzeSB0byBtYWtlIGZyZXF1ZW50IHVwZGF0ZXMvZXhjaGFuZ2VzIG9mIHNlc3Npb24Ka2V5
cyBiZXR3ZWVuIGF1dGhlbnRpY2F0ZWQgY2x1c3RlciBub2Rlcy4KCj4gQmFzaWNhbGx5LCB0aGVy
ZSBhcmUgdHdvIHNpdHVhdGlvbnMgd2hlcmUgdGhlIGtleSBleGNoYW5nZSB3aWxsCj4gdGFrZSBp
biBwbGFjZToKPgo+IC0gV2hlbiBhIG5ldyBub2RlIGpvaW5zIHRoZSBjbHVzdGVyICh3aXRoIHRo
ZSBtYXN0ZXIga2V5KSwgaXQgd2lsbCBuZWVkCj4gICAgdG8gZ2V0IGl0cyBwZWVyJ3MgVFgga2V5
LCBzbyB0aGF0IGJlIGFibGUgdG8gZGVjcnlwdCBmdXJ0aGVyIG1lc3NhZ2VzCj4gICAgZnJvbSB0
aGF0IHBlZXIuCj4KPiAtIFdoZW4gYSBuZXcgc2Vzc2lvbiBrZXkgaXMgZ2VuZXJhdGVkIChieSBl
aXRoZXIgdXNlciBtYW51YWwgc2V0dGluZyBvcgo+ICAgIGxhdGVyIGF1dG9tYXRpYyByZWtleWlu
ZyBmZWF0dXJlKSwgdGhlIGtleSB3aWxsIGJlIGRpc3RyaWJ1dGVkIHRvIGFsbAo+ICAgIHBlZXIg
bm9kZXMgaW4gdGhlIGNsdXN0ZXIuCj4KPiBBIGtleSB0byBiZSBleGNoYW5nZWQgaXMgZW5jYXBz
dWxhdGVkIGluIHRoZSBkYXRhIHBhcnQgb2YgYSAnTVNHX0NSWVBUTwo+IC9LRVlfRElTVFJfTVNH
JyBUSVBDIHYyIG1lc3NhZ2UsIHRoZW4geG1pdC1lZCBhcyB1c3VhbCBhbmQgZW5jcnlwdGVkIGJ5
Cj4gdXNpbmcgdGhlIG1hc3RlciBrZXkgYmVmb3JlIHNlbmRpbmcgb3V0LiBVcG9uIHJlY2VpcHQg
b2YgdGhlIG1lc3NhZ2UgaXQKPiB3aWxsIGJlIGRlY3J5cHRlZCBpbiB0aGUgc2FtZSB3YXkgYXMg
cmVndWxhciBtZXNzYWdlcywgdGhlbiBhdHRhY2hlZCBhcwo+IHRoZSBzZW5kZXIncyBSWCBrZXkg
aW4gdGhlIHJlY2VpdmVyIG5vZGUuCj4KPiBJbiB0aGlzIHdheSwgdGhlIGtleSBleGNoYW5nZSBp
cyByZWxpYWJsZSBieSB0aGUgbGluayBsYXllciwgYXMgd2VsbCBhcwo+IHNlY3VyaXR5LCBpbnRl
Z3JpdHkgYW5kIGF1dGhlbnRpY2l0eSBieSB0aGUgY3J5cHRvIGxheWVyLgo+Cj4gQWxzbywgdGhl
IGZvcndhcmQgc2VjdXJpdHkgd2lsbCBiZSBlYXNpbHkgYWNoaWV2ZWQgYnkgdXNlciBjaGFuZ2lu
ZyB0aGUKPiBtYXN0ZXIga2V5IGFjdGl2ZWx5IGJ1dAp0aGlzIHNob3VsZCBub3QgYmUgcmVxdWly
ZWQgdmVyeSBmcmVxdWVudGx5LgoKVGhlIGtleSBleGNoYW5nZSBmZWF0dXJlIGlzIGRlcGVuZGVu
dCBvbiB0aGUgcHJlc2VuY2Ugb2YgYSBtYXN0ZXIga2V5LAppcyBzdGlsbCBvcHRpb25hbC4gSXQg
Y2FuIGJlIHR1cm5lZCBvZmYvb24gdmlhCnN5c2ZzOiAnbmV0L3RpcGMva2V5X2V4Y2hhbmdlX2Vu
YWJsZWQnIChkZWZhdWx0IDE6IGVuYWJsZWQpLgpOb3RlIGhvd2V2ZXIgdGhhdCB0aGUgbWFzdGVy
IGtleSBzdGlsbCBpcyBuZWVkZWQgZm9yIG5ldyBub2RlcyB0byBiZSBhYmxlIHRvIGpvaW4gdGhl
IGNsdXN0ZXIuCgoKWW91IHNob3VsZCBtZW50aW9uIHNvbWV0aGluZyBhYm91dCBjb21wYXRpYmls
aXR5IGhlcmUuIERvZXMgdGhpcyBhbGxvdyBhIHNlYW1sZXNzIHVwZ3JhZGUgaW4gYSBjbHVzdGVy
IHdoZXJlIHdlIGhhdmUgZW5jcnlwdGlvbiBidXQgdGhlIG1hc3RlciBrZXkgaXMgbm90IHN1cHBv
cnRlZD8KCgogwqBTaWduZWQtb2ZmLWJ5OiBUdW9uZyBMaWVuIDx0dW9uZy50LmxpZW5AZGVrdGVj
aC5jb20uYXU+Ci0tLQogIG5ldC90aXBjL2NyeXB0by5jIHwgMzU5ICsrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKy0tLQogIG5ldC90aXBjL2NyeXB0by5o
IHwgIDI0ICsrKysKICBuZXQvdGlwYy9saW5rLmMgICB8ICAgNSArCiAgbmV0L3RpcGMvbXNnLmgg
ICAgfCAgIDYgKwogIG5ldC90aXBjL25vZGUuYyAgIHwgIDE5ICsrLQogIG5ldC90aXBjL25vZGUu
aCAgIHwgICAyICsKICBuZXQvdGlwYy9zeXNjdGwuYyB8ICAgOSArKwogIDcgZmlsZXMgY2hhbmdl
ZCwgNDA0IGluc2VydGlvbnMoKyksIDIwIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL25ldC90
aXBjL2NyeXB0by5jIGIvbmV0L3RpcGMvY3J5cHRvLmMKaW5kZXggN2M2ODhjZDBiMTNlLi45ZDAw
NTU1ZWRlODMgMTAwNjQ0Ci0tLSBhL25ldC90aXBjL2NyeXB0by5jCisrKyBiL25ldC90aXBjL2Ny
eXB0by5jCkBAIC0zNyw2ICszNyw4IEBACiAgI2luY2x1ZGUgPGNyeXB0by9hZWFkLmg+CiAgI2lu
Y2x1ZGUgPGNyeXB0by9hZXMuaD4KICAjaW5jbHVkZSAiY3J5cHRvLmgiCisjaW5jbHVkZSAibXNn
LmgiCisjaW5jbHVkZSAiYmNhc3QuaCIKICAKICAjZGVmaW5lIFRJUENfVFhfR1JBQ0VfUEVSSU9E
CW1zZWNzX3RvX2ppZmZpZXMoNTAwMCkgLyogNXMgKi8KICAjZGVmaW5lIFRJUENfVFhfTEFTVElO
R19USU1FCW1zZWNzX3RvX2ppZmZpZXMoMTAwMDApIC8qIDEwcyAqLwpAQCAtODIsNiArODQsOCBA
QCBzdGF0aWMgY29uc3QgY2hhciAqaHN0YXRzW01BWF9TVEFUU10gPSB7Im9rIiwgIm5vayIsICJh
c3luYyIsICJhc3luY19vayIsCiAgCiAgLyogTWF4IFRGTXMgbnVtYmVyIHBlciBrZXkgKi8KICBp
bnQgc3lzY3RsX3RpcGNfbWF4X3RmbXMgX19yZWFkX21vc3RseSA9IFRJUENfTUFYX1RGTVNfREVG
OworLyogS2V5IGV4Y2hhbmdlIHN3aXRjaCwgZGVmYXVsdDogb24gKi8KK2ludCBzeXNjdGxfdGlw
Y19rZXlfZXhjaGFuZ2VfZW5hYmxlZCBfX3JlYWRfbW9zdGx5ID0gMTsKICAKICAvKioKICAgKiBz
dHJ1Y3QgdGlwY19rZXkgLSBUSVBDIGtleXMnIHN0YXR1cyBpbmRpY2F0b3IKQEAgLTEzMyw2ICsx
MzcsOCBAQCBzdHJ1Y3QgdGlwY190Zm0gewogICAqIEBtb2RlOiBjcnlwdG8gbW9kZSBpcyBhcHBs
aWVkIHRvIHRoZSBrZXkKICAgKiBAaGludFtdOiBhIGhpbnQgZm9yIHVzZXIga2V5CiAgICogQHJj
dTogc3RydWN0IHJjdV9oZWFkCisgKiBAa2V5OiB0aGUgYWVhZCBrZXkKKyAqIEBnZW46IHRoZSBr
ZXkncyBnZW5lcmF0aW9uCiAgICogQHNlcW5vOiB0aGUga2V5IHNlcW5vIChjbHVzdGVyIHNjb3Bl
KQogICAqIEByZWZjbnQ6IHRoZSBrZXkgcmVmZXJlbmNlIGNvdW50ZXIKICAgKi8KQEAgLTE0Nyw2
ICsxNTMsOCBAQCBzdHJ1Y3QgdGlwY19hZWFkIHsKICAJdTggbW9kZTsKICAJY2hhciBoaW50WzIg
KiBUSVBDX0FFQURfSElOVF9MRU4gKyAxXTsKICAJc3RydWN0IHJjdV9oZWFkIHJjdTsKKwlzdHJ1
Y3QgdGlwY19hZWFkX2tleSAqa2V5OworCXUxNiBnZW47CiAgCiAgCWF0b21pYzY0X3Qgc2Vxbm8g
X19fX2NhY2hlbGluZV9hbGlnbmVkOwogIAlyZWZjb3VudF90IHJlZmNudCBfX19fY2FjaGVsaW5l
X2FsaWduZWQ7CkBAIC0xNjYsNyArMTc0LDEzIEBAIHN0cnVjdCB0aXBjX2NyeXB0b19zdGF0cyB7
CiAgICogQG5vZGU6IFRJUEMgbm9kZSAoUlgpCiAgICogQGFlYWQ6IGFycmF5IG9mIHBvaW50ZXJz
IHRvIEFFQUQga2V5cyBmb3IgZW5jcnlwdGlvbi9kZWNyeXB0aW9uCiAgICogQHBlZXJfcnhfYWN0
aXZlOiByZXBsaWNhdGVkIHBlZXIgUlggYWN0aXZlIGtleSBpbmRleAorICogQGtleV9nZW46IFRY
L1JYIGtleSBnZW5lcmF0aW9uCiAgICogQGtleTogdGhlIGtleSBzdGF0ZXMKKyAqIEBza2V5X21v
ZGU6IHNlc3Npb24ga2V5J3MgbW9kZQorICogQHNrZXk6IHJlY2VpdmVkIHNlc3Npb24ga2V5Cisg
KiBAd3E6IGNvbW1vbiB3b3JrcXVldWUgb24gVFggY3J5cHRvCisgKiBAd29yazogZGVsYXllZCB3
b3JrIHNjaGVkIGZvciBUWC9SWAorICogQGtleV9kaXN0cjoga2V5IGRpc3RyaWJ1dGluZyBzdGF0
ZQogICAqIEBzdGF0czogdGhlIGNyeXB0byBzdGF0aXN0aWNzCiAgICogQG5hbWU6IHRoZSBjcnlw
dG8gbmFtZQogICAqIEBzbmRueHQ6IHRoZSBwZXItcGVlciBzbmRueHQgKFRYKQpAQCAtMTc1LDYg
KzE4OSw3IEBAIHN0cnVjdCB0aXBjX2NyeXB0b19zdGF0cyB7CiAgICogQHdvcmtpbmc6IHRoZSBj
cnlwdG8gaXMgd29ya2luZyBvciBub3QKICAgKiBAa2V5X21hc3RlcjogZmxhZyBpbmRpY2F0ZXMg
aWYgbWFzdGVyIGtleSBleGlzdHMKICAgKiBAbGVnYWN5X3VzZXI6IGZsYWcgaW5kaWNhdGVzIGlm
IGEgcGVlciBqb2lucyB3L28gbWFzdGVyIGtleSAoZm9yIGJ3ZCBjb21wLikKKyAqIEBub2tleTog
bm8ga2V5IGluZGljYXRpb24KICAgKiBAbG9jazogdGlwY19rZXkgbG9jawogICAqLwogIHN0cnVj
dCB0aXBjX2NyeXB0byB7CkBAIC0xODIsNyArMTk3LDE2IEBAIHN0cnVjdCB0aXBjX2NyeXB0byB7
CiAgCXN0cnVjdCB0aXBjX25vZGUgKm5vZGU7CiAgCXN0cnVjdCB0aXBjX2FlYWQgX19yY3UgKmFl
YWRbS0VZX01BWCArIDFdOwogIAlhdG9taWNfdCBwZWVyX3J4X2FjdGl2ZTsKKwl1MTYga2V5X2dl
bjsKICAJc3RydWN0IHRpcGNfa2V5IGtleTsKKwl1OCBza2V5X21vZGU7CisJc3RydWN0IHRpcGNf
YWVhZF9rZXkgKnNrZXk7CisJc3RydWN0IHdvcmtxdWV1ZV9zdHJ1Y3QgKndxOworCXN0cnVjdCBk
ZWxheWVkX3dvcmsgd29yazsKKyNkZWZpbmUgS0VZX0RJU1RSX1NDSEVECQkxCisjZGVmaW5lIEtF
WV9ESVNUUl9DT01QTAkJMgorCWF0b21pY190IGtleV9kaXN0cjsKKwogIAlzdHJ1Y3QgdGlwY19j
cnlwdG9fc3RhdHMgX19wZXJjcHUgKnN0YXRzOwogIAljaGFyIG5hbWVbNDhdOwogIApAQCAtMTk0
LDYgKzIxOCw3IEBAIHN0cnVjdCB0aXBjX2NyeXB0byB7CiAgCQkJdTggd29ya2luZzoxOwogIAkJ
CXU4IGtleV9tYXN0ZXI6MTsKICAJCQl1OCBsZWdhY3lfdXNlcjoxOworCQkJdTggbm9rZXk6IDE7
CiAgCQl9OwogIAkJdTggZmxhZ3M7CiAgCX07CkBAIC0yNjYsNiArMjkxLDExIEBAIHN0YXRpYyB2
b2lkIHRpcGNfY3J5cHRvX2RvX2NtZChzdHJ1Y3QgbmV0ICpuZXQsIGludCBjbWQpOwogIHN0YXRp
YyBjaGFyICp0aXBjX2NyeXB0b19rZXlfZHVtcChzdHJ1Y3QgdGlwY19jcnlwdG8gKmMsIGNoYXIg
KmJ1Zik7CiAgc3RhdGljIGNoYXIgKnRpcGNfa2V5X2NoYW5nZV9kdW1wKHN0cnVjdCB0aXBjX2tl
eSBvbGQsIHN0cnVjdCB0aXBjX2tleSBuZXcsCiAgCQkJCSAgY2hhciAqYnVmKTsKK3N0YXRpYyBp
bnQgdGlwY19jcnlwdG9fa2V5X3htaXQoc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3QgdGlwY19hZWFk
X2tleSAqc2tleSwKKwkJCQl1MTYgZ2VuLCB1OCBtb2RlLCB1MzIgZG5vZGUpOworc3RhdGljIGJv
b2wgdGlwY19jcnlwdG9fa2V5X3JjdihzdHJ1Y3QgdGlwY19jcnlwdG8gKnJ4LCBzdHJ1Y3QgdGlw
Y19tc2cgKmhkcik7CitzdGF0aWMgdm9pZCB0aXBjX2NyeXB0b193b3JrX3J4KHN0cnVjdCB3b3Jr
X3N0cnVjdCAqd29yayk7CisKICAjZGVmaW5lIGlzX3R4KGNyeXB0bykgKCEoY3J5cHRvKS0+bm9k
ZSkKICAjZGVmaW5lIGlzX3J4KGNyeXB0bykgKCFpc190eChjcnlwdG8pKQogIApAQCAtMzU2LDYg
KzM4Niw3IEBAIHN0YXRpYyB2b2lkIHRpcGNfYWVhZF9mcmVlKHN0cnVjdCByY3VfaGVhZCAqcnAp
CiAgCQlrZnJlZShoZWFkKTsKICAJfQogIAlmcmVlX3BlcmNwdShhZWFkLT50Zm1fZW50cnkpOwor
CWt6ZnJlZShhZWFkLT5rZXkpOwogIAlrZnJlZShhZWFkKTsKICB9CiAgCkBAIC01MjYsNiArNTU3
LDcgQEAgc3RhdGljIGludCB0aXBjX2FlYWRfaW5pdChzdHJ1Y3QgdGlwY19hZWFkICoqYWVhZCwg
c3RydWN0IHRpcGNfYWVhZF9rZXkgKnVrZXksCiAgCXRtcC0+bW9kZSA9IG1vZGU7CiAgCXRtcC0+
Y2xvbmVkID0gTlVMTDsKICAJdG1wLT5hdXRoc2l6ZSA9IFRJUENfQUVTX0dDTV9UQUdfU0laRTsK
Kwl0bXAtPmtleSA9IGttZW1kdXAodWtleSwgdGlwY19hZWFkX2tleV9zaXplKHVrZXkpLCBHRlBf
S0VSTkVMKTsKICAJbWVtY3B5KCZ0bXAtPnNhbHQsIHVrZXktPmtleSArIGtleWxlbiwgVElQQ19B
RVNfR0NNX1NBTFRfU0laRSk7CiAgCWF0b21pY19zZXQoJnRtcC0+dXNlcnMsIDApOwogIAlhdG9t
aWM2NF9zZXQoJnRtcC0+c2Vxbm8sIDApOwpAQCAtMTAwNSw3ICsxMDM3LDcgQEAgc3RhdGljIGlu
dCB0aXBjX2VoZHJfYnVpbGQoc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3QgdGlwY19hZWFkICphZWFk
LAogIAllaGRyLT50eF9rZXkgPSB0eF9rZXk7CiAgCWVoZHItPmRlc3RpbmVkID0gKF9fcngpID8g
MSA6IDA7CiAgCWVoZHItPnJ4X2tleV9hY3RpdmUgPSAoX19yeCkgPyBfX3J4LT5rZXkuYWN0aXZl
IDogMDsKLQllaGRyLT5yeF9ub2tleSA9IChfX3J4KSA/ICFfX3J4LT5rZXkua2V5cyA6IDA7CisJ
ZWhkci0+cnhfbm9rZXkgPSAoX19yeCkgPyBfX3J4LT5ub2tleSA6IDA7CiAgCWVoZHItPm1hc3Rl
cl9rZXkgPSBhZWFkLT5jcnlwdG8tPmtleV9tYXN0ZXI7CiAgCWVoZHItPnJlc2VydmVkXzEgPSAw
OwogIAllaGRyLT5yZXNlcnZlZF8yID0gMDsKQEAgLTExMzAsMTEgKzExNjIsMTMgQEAgc3RhdGlj
IGludCB0aXBjX2NyeXB0b19rZXlfYXR0YWNoKHN0cnVjdCB0aXBjX2NyeXB0byAqYywKICAKICBh
dHRhY2g6CiAgCWFlYWQtPmNyeXB0byA9IGM7CisJYWVhZC0+Z2VuID0gKGlzX3R4KGMpKSA/ICsr
Yy0+a2V5X2dlbiA6IGMtPmtleV9nZW47CiAgCXRpcGNfYWVhZF9yY3VfcmVwbGFjZShjLT5hZWFk
W25ld19rZXldLCBhZWFkLCAmYy0+bG9jayk7CiAgCWlmIChsaWtlbHkoYy0+a2V5LmtleXMgIT0g
a2V5LmtleXMpKQogIAkJdGlwY19jcnlwdG9fa2V5X3NldF9zdGF0ZShjLCBrZXkucGFzc2l2ZSwg
a2V5LmFjdGl2ZSwKICAJCQkJCSAga2V5LnBlbmRpbmcpOwogIAljLT53b3JraW5nID0gMTsKKwlj
LT5ub2tleSA9IDA7CiAgCWMtPmtleV9tYXN0ZXIgfD0gbWFzdGVyX2tleTsKICAJcmMgPSBuZXdf
a2V5OwogIApAQCAtMTE0NSwxNCArMTE3OSwzMyBAQCBzdGF0aWMgaW50IHRpcGNfY3J5cHRvX2tl
eV9hdHRhY2goc3RydWN0IHRpcGNfY3J5cHRvICpjLAogIAogIHZvaWQgdGlwY19jcnlwdG9fa2V5
X2ZsdXNoKHN0cnVjdCB0aXBjX2NyeXB0byAqYykKICB7CisJc3RydWN0IHRpcGNfY3J5cHRvICp0
eCwgKnJ4OwogIAlpbnQgazsKICAKICAJc3Bpbl9sb2NrX2JoKCZjLT5sb2NrKTsKKwlpZiAoaXNf
cngoYykpIHsKKwkJLyogVHJ5IHRvIGNhbmNlbCBwZW5kaW5nIHdvcmsgKi8KKwkJcnggPSBjOwor
CQl0eCA9IHRpcGNfbmV0KHJ4LT5uZXQpLT5jcnlwdG9fdHg7CisJCWlmIChjYW5jZWxfZGVsYXll
ZF93b3JrKCZyeC0+d29yaykpIHsKKwkJCWtmcmVlKHJ4LT5za2V5KTsKKwkJCXJ4LT5za2V5ID0g
TlVMTDsKKwkJCWF0b21pY194Y2hnKCZyeC0+a2V5X2Rpc3RyLCAwKTsKKwkJCXRpcGNfbm9kZV9w
dXQocngtPm5vZGUpOworCQl9CisJCS8qIFJYIHN0b3BwaW5nID0+IGRlY3JlYXNlIFRYIGtleSB1
c2VycyBpZiBhbnkgKi8KKwkJayA9IGF0b21pY194Y2hnKCZyeC0+cGVlcl9yeF9hY3RpdmUsIDAp
OworCQlpZiAoaykgeworCQkJdGlwY19hZWFkX3VzZXJzX2RlYyh0eC0+YWVhZFtrXSwgMCk7CisJ
CQkvKiBNYXJrIHRoZSBwb2ludCBUWCBrZXkgdXNlcnMgY2hhbmdlZCAqLworCQkJdHgtPnRpbWVy
MSA9IGppZmZpZXM7CisJCX0KKwl9CisKICAJYy0+ZmxhZ3MgPSAwOwogIAl0aXBjX2NyeXB0b19r
ZXlfc2V0X3N0YXRlKGMsIDAsIDAsIDApOwogIAlmb3IgKGsgPSBLRVlfTUlOOyBrIDw9IEtFWV9N
QVg7IGsrKykKICAJCXRpcGNfY3J5cHRvX2tleV9kZXRhY2goYy0+YWVhZFtrXSwgJmMtPmxvY2sp
OwotCWF0b21pY19zZXQoJmMtPnBlZXJfcnhfYWN0aXZlLCAwKTsKICAJYXRvbWljNjRfc2V0KCZj
LT5zbmRueHQsIDApOwogIAlzcGluX3VubG9ja19iaCgmYy0+bG9jayk7CiAgfQpAQCAtMTI5OCw3
ICsxMzUxLDggQEAgc3RhdGljIHN0cnVjdCB0aXBjX2FlYWQgKnRpcGNfY3J5cHRvX2tleV9waWNr
X3R4KHN0cnVjdCB0aXBjX2NyeXB0byAqdHgsCiAgICogZGVjcmVhc2VkIGNvcnJlc3BvbmRpbmds
eS4KICAgKgogICAqIEl0IGFsc28gY29uc2lkZXJzIGlmIHBlZXIgaGFzIG5vIGtleSwgdGhlbiB3
ZSBuZWVkIHRvIG1ha2Ugb3duIG1hc3RlciBrZXkKLSAqIChpZiBhbnkpIHRha2luZyBvdmVyIGku
ZS4gc3RhcnRpbmcgZ3JhY2UgcGVyaW9kLgorICogKGlmIGFueSkgdGFraW5nIG92ZXIgaS5lLiBz
dGFydGluZyBncmFjZSBwZXJpb2QgYW5kIGFsc28gdHJpZ2dlciBrZXkKKyAqIGRpc3RyaWJ1dGlu
ZyBwcm9jZXNzLgogICAqCiAgICogVGhlICJwZXItcGVlciIgc25kbnh0IGlzIGFsc28gcmVzZXQg
d2hlbiB0aGUgcGVlciBrZXkgaGFzIHN3aXRjaGVkLgogICAqLwpAQCAtMTMwOSw2ICsxMzYzLDcg
QEAgc3RhdGljIHZvaWQgdGlwY19jcnlwdG9fa2V5X3N5bmNoKHN0cnVjdCB0aXBjX2NyeXB0byAq
cngsIHN0cnVjdCBza19idWZmICpza2IpCiAgCXN0cnVjdCB0aXBjX21zZyAqaGRyID0gYnVmX21z
Zyhza2IpOwogIAl1MzIgc2VsZiA9IHRpcGNfb3duX2FkZHIocngtPm5ldCk7CiAgCXU4IGN1ciwg
bmV3OworCXVuc2lnbmVkIGxvbmcgZGVsYXk7CiAgCiAgCS8qIFVwZGF0ZSBSWCAna2V5X21hc3Rl
cicgZmxhZyBhY2NvcmRpbmcgdG8gcGVlciwgYWxzbyBtYXJrICJsZWdhY3kiIGlmCiAgCSAqIGEg
cGVlciBoYXMgbm8gbWFzdGVyIGtleS4KQEAgLTEzMjIsOSArMTM3NywyMiBAQCBzdGF0aWMgdm9p
ZCB0aXBjX2NyeXB0b19rZXlfc3luY2goc3RydWN0IHRpcGNfY3J5cHRvICpyeCwgc3RydWN0IHNr
X2J1ZmYgKnNrYikKICAJCXJldHVybjsKICAKICAJLyogQ2FzZSAxOiBQZWVyIGhhcyBubyBrZXlz
LCBsZXQncyBtYWtlIG1hc3RlciBrZXkgdGFraW5nIG92ZXIgKi8KLQlpZiAoZWhkci0+cnhfbm9r
ZXkpCisJaWYgKGVoZHItPnJ4X25va2V5KSB7CiAgCQkvKiBTZXQgb3IgZXh0ZW5kIGdyYWNlIHBl
cmlvZCAqLwogIAkJdHgtPnRpbWVyMiA9IGppZmZpZXM7CisJCS8qIFNjaGVkdWxlIGtleSBkaXN0
cmlidXRpbmcgZm9yIHRoZSBwZWVyIGlmIG5vdCB5ZXQgKi8KKwkJaWYgKHR4LT5rZXkua2V5cyAm
JgorCQkgICAgIWF0b21pY19jbXB4Y2hnKCZyeC0+a2V5X2Rpc3RyLCAwLCBLRVlfRElTVFJfU0NI
RUQpKSB7CisJCQlnZXRfcmFuZG9tX2J5dGVzKCZkZWxheSwgMik7CisJCQlkZWxheSAlPSA1Owor
CQkJZGVsYXkgPSBtc2Vjc190b19qaWZmaWVzKDUwMCAqICsrZGVsYXkpOworCQkJaWYgKHF1ZXVl
X2RlbGF5ZWRfd29yayh0eC0+d3EsICZyeC0+d29yaywgZGVsYXkpKQorCQkJCXRpcGNfbm9kZV9n
ZXQocngtPm5vZGUpOworCQl9CisJfSBlbHNlIHsKKwkJLyogQ2FuY2VsIGEgcGVuZGluZyBrZXkg
ZGlzdHJpYnV0aW5nIGlmIGFueSAqLworCQlhdG9taWNfeGNoZygmcngtPmtleV9kaXN0ciwgMCk7
CisJfQogIAogIAkvKiBDYXNlIDI6IFBlZXIgUlggYWN0aXZlIGtleSBoYXMgY2hhbmdlZCwgbGV0
J3MgdXBkYXRlIG93biBUWCB1c2VycyAqLwogIAljdXIgPSBhdG9taWNfcmVhZCgmcngtPnBlZXJf
cnhfYWN0aXZlKTsKQEAgLTEzNzcsNiArMTQ0NSwxNSBAQCBpbnQgdGlwY19jcnlwdG9fc3RhcnQo
c3RydWN0IHRpcGNfY3J5cHRvICoqY3J5cHRvLCBzdHJ1Y3QgbmV0ICpuZXQsCiAgCWlmICghYykK
ICAJCXJldHVybiAtRU5PTUVNOwogIAorCS8qIEFsbG9jYXRlIHdvcmtxdWV1ZSBvbiBUWCAqLwor
CWlmICghbm9kZSkgeworCQljLT53cSA9IGFsbG9jX29yZGVyZWRfd29ya3F1ZXVlKCJ0aXBjX2Ny
eXB0byIsIDApOworCQlpZiAoIWMtPndxKSB7CisJCQlrZnJlZShjKTsKKwkJCXJldHVybiAtRU5P
TUVNOworCQl9CisJfQorCiAgCS8qIEFsbG9jYXRlIHN0YXRpc3RpYyBzdHJ1Y3R1cmUgKi8KICAJ
Yy0+c3RhdHMgPSBhbGxvY19wZXJjcHVfZ2ZwKHN0cnVjdCB0aXBjX2NyeXB0b19zdGF0cywgR0ZQ
X0FUT01JQyk7CiAgCWlmICghYy0+c3RhdHMpIHsKQEAgLTEzODcsNyArMTQ2NCw5IEBAIGludCB0
aXBjX2NyeXB0b19zdGFydChzdHJ1Y3QgdGlwY19jcnlwdG8gKipjcnlwdG8sIHN0cnVjdCBuZXQg
Km5ldCwKICAJYy0+ZmxhZ3MgPSAwOwogIAljLT5uZXQgPSBuZXQ7CiAgCWMtPm5vZGUgPSBub2Rl
OworCWdldF9yYW5kb21fYnl0ZXMoJmMtPmtleV9nZW4sIDIpOwogIAl0aXBjX2NyeXB0b19rZXlf
c2V0X3N0YXRlKGMsIDAsIDAsIDApOworCWF0b21pY19zZXQoJmMtPmtleV9kaXN0ciwgMCk7CiAg
CWF0b21pY19zZXQoJmMtPnBlZXJfcnhfYWN0aXZlLCAwKTsKICAJYXRvbWljNjRfc2V0KCZjLT5z
bmRueHQsIDApOwogIAljLT50aW1lcjEgPSBqaWZmaWVzOwpAQCAtMTM5NywzMiArMTQ3NiwyNyBA
QCBpbnQgdGlwY19jcnlwdG9fc3RhcnQoc3RydWN0IHRpcGNfY3J5cHRvICoqY3J5cHRvLCBzdHJ1
Y3QgbmV0ICpuZXQsCiAgCQkgIChpc19yeChjKSkgPyB0aXBjX25vZGVfZ2V0X2lkX3N0cihjLT5u
b2RlKSA6CiAgCQkJICAgICAgIHRpcGNfb3duX2lkX3N0cmluZyhjLT5uZXQpKTsKICAKKyAgICAg
ICAgaWYgKGlzX3J4KGMpKQorICAgICAgICAgICAgICAgIElOSVRfREVMQVlFRF9XT1JLKCZjLT53
b3JrLCB0aXBjX2NyeXB0b193b3JrX3J4KTsKKwogIAkqY3J5cHRvID0gYzsKICAJcmV0dXJuIDA7
CiAgfQogIAogIHZvaWQgdGlwY19jcnlwdG9fc3RvcChzdHJ1Y3QgdGlwY19jcnlwdG8gKipjcnlw
dG8pCiAgewotCXN0cnVjdCB0aXBjX2NyeXB0byAqYyA9ICpjcnlwdG8sICp0eCwgKnJ4OworCXN0
cnVjdCB0aXBjX2NyeXB0byAqYyA9ICpjcnlwdG87CiAgCXU4IGs7CiAgCiAgCWlmICghYykKICAJ
CXJldHVybjsKICAKLQlyY3VfcmVhZF9sb2NrKCk7Ci0JLyogUlggc3RvcHBpbmc/ID0+IGRlY3Jl
YXNlIFRYIGtleSB1c2VycyBpZiBhbnkgKi8KLQlpZiAoaXNfcngoYykpIHsKLQkJcnggPSBjOwot
CQl0eCA9IHRpcGNfbmV0KHJ4LT5uZXQpLT5jcnlwdG9fdHg7Ci0JCWsgPSBhdG9taWNfcmVhZCgm
cngtPnBlZXJfcnhfYWN0aXZlKTsKLQkJaWYgKGspIHsKLQkJCXRpcGNfYWVhZF91c2Vyc19kZWMo
dHgtPmFlYWRba10sIDApOwotCQkJLyogTWFyayB0aGUgcG9pbnQgVFgga2V5IHVzZXJzIGNoYW5n
ZWQgKi8KLQkJCXR4LT50aW1lcjEgPSBqaWZmaWVzOwotCQl9Ci0JfQorCS8qIEZsdXNoIGFueSBx
dWV1ZWQgd29ya3MgJiBkZXN0cm95IHdxICovCisJaWYgKGlzX3R4KGMpKQorCQlkZXN0cm95X3dv
cmtxdWV1ZShjLT53cSk7CiAgCiAgCS8qIFJlbGVhc2UgQUVBRCBrZXlzICovCisJcmN1X3JlYWRf
bG9jaygpOwogIAlmb3IgKGsgPSBLRVlfTUlOOyBrIDw9IEtFWV9NQVg7IGsrKykKICAJCXRpcGNf
YWVhZF9wdXQocmN1X2RlcmVmZXJlbmNlKGMtPmFlYWRba10pKTsKICAJcmN1X3JlYWRfdW5sb2Nr
KCk7CkBAIC0xNjIxLDYgKzE2OTUsNyBAQCBpbnQgdGlwY19jcnlwdG9feG1pdChzdHJ1Y3QgbmV0
ICpuZXQsIHN0cnVjdCBza19idWZmICoqc2tiLAogIAkJfQogIAkJaWYgKHVzZXIgPT0gTElOS19D
T05GSUcgfHwKICAJCSAgICAodXNlciA9PSBMSU5LX1BST1RPQ09MICYmIHR5cGUgPT0gUkVTRVRf
TVNHKSB8fAorCQkgICAgKHVzZXIgPT0gTVNHX0NSWVBUTyAmJiB0eXBlID09IEtFWV9ESVNUUl9N
U0cpIHx8CiAgCQkgICAgdGltZV9iZWZvcmUoamlmZmllcywgdHgtPnRpbWVyMiArIFRJUENfVFhf
R1JBQ0VfUEVSSU9EKSkgewogIAkJCWlmIChfX3J4ICYmIF9fcngtPmtleV9tYXN0ZXIgJiYKICAJ
CQkgICAgIWF0b21pY19yZWFkKCZfX3J4LT5wZWVyX3J4X2FjdGl2ZSkpCkBAIC0xNzA1LDcgKzE3
ODAsNyBAQCBpbnQgdGlwY19jcnlwdG9fcmN2KHN0cnVjdCBuZXQgKm5ldCwgc3RydWN0IHRpcGNf
Y3J5cHRvICpyeCwKICAJc3RydWN0IHRpcGNfYWVhZCAqYWVhZCA9IE5VTEw7CiAgCXN0cnVjdCB0
aXBjX2tleSBrZXk7CiAgCWludCByYyA9IC1FTk9LRVk7Ci0JdTggdHhfa2V5OworCXU4IHR4X2tl
eSwgbjsKICAKICAJdHhfa2V5ID0gKChzdHJ1Y3QgdGlwY19laGRyICopKCpza2IpLT5kYXRhKS0+
dHhfa2V5OwogIApAQCAtMTc1NSw4ICsxODMwLDE5IEBAIGludCB0aXBjX2NyeXB0b19yY3Yoc3Ry
dWN0IG5ldCAqbmV0LCBzdHJ1Y3QgdGlwY19jcnlwdG8gKnJ4LAogIAkJaWYgKHJjID09IC1FTk9L
RVkpIHsKICAJCQlrZnJlZV9za2IoKnNrYik7CiAgCQkJKnNrYiA9IE5VTEw7Ci0JCQlpZiAocngp
CisJCQlpZiAocngpIHsKKwkJCQkvKiBNYXJrIHJ4LT5ub2tleSBvbmx5IGlmIHdlIGRvbnQgaGF2
ZSBhCisJCQkJICogcGVuZGluZyByZWNlaXZlZCBzZXNzaW9uIGtleSwgbm9yIGEgbmV3ZXIKKwkJ
CQkgKiBvbmUgaS5lLiBpbiB0aGUgbmV4dCBzbG90LgorCQkJCSAqLworCQkJCW4gPSBrZXlfbmV4
dCh0eF9rZXkpOworCQkJCXJ4LT5ub2tleSA9ICEocngtPnNrZXkgfHwKKwkJCQkJICAgICAgcmN1
X2FjY2Vzc19wb2ludGVyKHJ4LT5hZWFkW25dKSk7CisJCQkJcHJfZGVidWdfcmF0ZWxpbWl0ZWQo
IiVzOiBub2tleSAlZCwga2V5ICVkLyV4XG4iLAorCQkJCQkJICAgICByeC0+bmFtZSwgcngtPm5v
a2V5LAorCQkJCQkJICAgICB0eF9rZXksIHJ4LT5rZXkua2V5cyk7CiAgCQkJCXRpcGNfbm9kZV9w
dXQocngtPm5vZGUpOworCQkJfQogIAkJCXRoaXNfY3B1X2luYyhzdGF0cy0+c3RhdFtTVEFUX05P
S0VZU10pOwogIAkJCXJldHVybiByYzsKICAJCX0gZWxzZSBpZiAocmMgPT0gLUVCQURNU0cpIHsK
QEAgLTIwMjUsMyArMjExMSwyMzggQEAgc3RhdGljIGNoYXIgKnRpcGNfa2V5X2NoYW5nZV9kdW1w
KHN0cnVjdCB0aXBjX2tleSBvbGQsIHN0cnVjdCB0aXBjX2tleSBuZXcsCiAgCWkgKz0gc2NucHJp
bnRmKGJ1ZiArIGksIDMyIC0gaSwgIl0iKTsKICAJcmV0dXJuIGJ1ZjsKICB9CisKKy8qKgorICog
dGlwY19jcnlwdG9fbXNnX3JjdiAtIENvbW1vbiAnTVNHX0NSWVBUTycgcHJvY2Vzc2luZyBwb2lu
dAorICogQG5ldDogdGhlIHN0cnVjdCBuZXQKKyAqIEBza2I6IHRoZSByZWNldmluZyBtZXNzYWdl
IGJ1ZmZlcgorICovCit2b2lkIHRpcGNfY3J5cHRvX21zZ19yY3Yoc3RydWN0IG5ldCAqbmV0LCBz
dHJ1Y3Qgc2tfYnVmZiAqc2tiKQoreworCXN0cnVjdCB0aXBjX21zZyAqaGRyID0gYnVmX21zZyhz
a2IpOworCXN0cnVjdCB0aXBjX2NyeXB0byAqcng7CisKKwlyeCA9IHRpcGNfbm9kZV9jcnlwdG9f
cnhfYnlfYWRkcihuZXQsIG1zZ19wcmV2bm9kZShoZHIpKTsKKwlpZiAodW5saWtlbHkoIXJ4KSkK
KwkJZ290byBleGl0OworCisJc3dpdGNoIChtc2dfdHlwZShoZHIpKSB7CisJY2FzZSBLRVlfRElT
VFJfTVNHOgorCQlpZiAodGlwY19jcnlwdG9fa2V5X3JjdihyeCwgaGRyKSkKKwkJCWdvdG8gZXhp
dDsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJYnJlYWs7CisJfQorCisJdGlwY19ub2RlX3B1dChy
eC0+bm9kZSk7CisKK2V4aXQ6CisJa2ZyZWVfc2tiKHNrYik7Cit9CisKKy8qKgorICogdGlwY19j
cnlwdG9fa2V5X2Rpc3RyIC0gRGlzdHJpYnV0ZSBhIFRYIGtleQorICogQHR4OiB0aGUgVFggY3J5
cHRvCisgKiBAa2V5OiB0aGUga2V5J3MgaW5kZXgKKyAqIEBkZXN0OiB0aGUgZGVzdGluYXRpb24g
dGlwYyBub2RlLCA9IE5VTEwgaWYgZGlzdHJpYnV0aW5nIHRvIGFsbCBub2RlcworICoKKyAqIFJl
dHVybjogMCBpbiBjYXNlIG9mIHN1Y2Nlc3MsIG90aGVyd2lzZSA8IDAKKyAqLworaW50IHRpcGNf
Y3J5cHRvX2tleV9kaXN0cihzdHJ1Y3QgdGlwY19jcnlwdG8gKnR4LCB1OCBrZXksCisJCQkgIHN0
cnVjdCB0aXBjX25vZGUgKmRlc3QpCit7CisJc3RydWN0IHRpcGNfYWVhZCAqYWVhZDsKKwljaGFy
ICpkc3RyID0gKGRlc3QpID8gdGlwY19ub2RlX2dldF9pZF9zdHIoZGVzdCkgOiAiYWxsIjsKKwl1
MzIgZG5vZGUgPSB0aXBjX25vZGVfZ2V0X2FkZHIoZGVzdCk7CisJaW50IHJjID0gLUVOT0tFWTsK
KworCWlmICghc3lzY3RsX3RpcGNfa2V5X2V4Y2hhbmdlX2VuYWJsZWQpCisJCXJldHVybiAwOwor
CisJaWYgKGtleSkgeworCQlyY3VfcmVhZF9sb2NrKCk7CisJCWFlYWQgPSB0aXBjX2FlYWRfZ2V0
KHR4LT5hZWFkW2tleV0pOworCQlpZiAobGlrZWx5KGFlYWQpKSB7CisJCQlyYyA9IHRpcGNfY3J5
cHRvX2tleV94bWl0KHR4LT5uZXQsIGFlYWQtPmtleSwKKwkJCQkJCSAgYWVhZC0+Z2VuLCBhZWFk
LT5tb2RlLAorCQkJCQkJICBkbm9kZSk7CisJCQl0aXBjX2FlYWRfcHV0KGFlYWQpOworCQl9CisJ
CXJjdV9yZWFkX3VubG9jaygpOworCX0KKworCWlmIChsaWtlbHkoIXJjKSkKKwkJcHJfaW5mbygi
JXM6IGtleVslZF0gaXMgZGlzdHJpYnV0ZWQgdG8gJXNcbiIsCisJCQl0eC0+bmFtZSwga2V5LCBk
c3RyKTsKKwllbHNlCisJCXByX3dhcm4oIiVzOiB1bmFibGUgdG8gZGlzdHIga2V5WyVkXSB0byAl
cywgZXJyICVkXG4iLAorCQkJdHgtPm5hbWUsIGtleSwgZHN0ciwgcmMpOworCisJcmV0dXJuIHJj
OworfQorCisvKioKKyAqIHRpcGNfY3J5cHRvX2tleV94bWl0IC0gU2VuZCBhIHNlc3Npb24ga2V5
CisgKiBAbmV0OiB0aGUgc3RydWN0IG5ldAorICogQHNrZXk6IHRoZSBzZXNzaW9uIGtleSB0byBi
ZSBzZW50CisgKiBAZ2VuOiB0aGUga2V5J3MgZ2VuZXJhdGlvbgorICogQG1vZGU6IHRoZSBrZXkn
cyBtb2RlCisgKiBAZG5vZGU6IHRoZSBkZXN0aW5hdGlvbiBub2RlIGFkZHJlc3MsID0gMCBpZiBi
cm9hZGNhc3RpbmcgdG8gYWxsIG5vZGVzCisgKgorICogVGhlIHNlc3Npb24ga2V5ICdza2V5JyBp
cyBwYWNrZWQgaW4gYSBUSVBDIHYyICdNU0dfQ1JZUFRPL0tFWV9ESVNUUl9NU0cnCisgKiBhcyBp
dHMgZGF0YSBzZWN0aW9uLCB0aGVuIHhtaXQtZWQgdGhyb3VnaCB0aGUgdWMvYmMgbGluay4KKyAq
CisgKiBSZXR1cm46IDAgaW4gY2FzZSBvZiBzdWNjZXNzLCBvdGhlcndpc2UgPCAwCisgKi8KK3N0
YXRpYyBpbnQgdGlwY19jcnlwdG9fa2V5X3htaXQoc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3QgdGlw
Y19hZWFkX2tleSAqc2tleSwKKwkJCQl1MTYgZ2VuLCB1OCBtb2RlLCB1MzIgZG5vZGUpCit7CisJ
c3RydWN0IHNrX2J1ZmZfaGVhZCBwa3RzOworCXN0cnVjdCB0aXBjX21zZyAqaGRyOworCXN0cnVj
dCBza19idWZmICpza2I7CisJdTE2IHNpemUsIGNvbmdfbGlua19jbnQ7CisJdTggKmRhdGE7CisJ
aW50IHJjOworCisJc2l6ZSA9IHRpcGNfYWVhZF9rZXlfc2l6ZShza2V5KTsKKwlza2IgPSB0aXBj
X2J1Zl9hY3F1aXJlKElOVF9IX1NJWkUgKyBzaXplLCBHRlBfQVRPTUlDKTsKKwlpZiAoIXNrYikK
KwkJcmV0dXJuIC1FTk9NRU07CisKKwloZHIgPSBidWZfbXNnKHNrYik7CisJdGlwY19tc2dfaW5p
dCh0aXBjX293bl9hZGRyKG5ldCksIGhkciwgTVNHX0NSWVBUTywgS0VZX0RJU1RSX01TRywKKwkJ
ICAgICAgSU5UX0hfU0laRSwgZG5vZGUpOworCW1zZ19zZXRfc2l6ZShoZHIsIElOVF9IX1NJWkUg
KyBzaXplKTsKKwltc2dfc2V0X2tleV9nZW4oaGRyLCBnZW4pOworCW1zZ19zZXRfa2V5X21vZGUo
aGRyLCBtb2RlKTsKKworCWRhdGEgPSBtc2dfZGF0YShoZHIpOworCSooKF9fYmUzMiAqKShkYXRh
ICsgVElQQ19BRUFEX0FMR19OQU1FKSkgPSBodG9ubChza2V5LT5rZXlsZW4pOworCW1lbWNweShk
YXRhLCBza2V5LT5hbGdfbmFtZSwgVElQQ19BRUFEX0FMR19OQU1FKTsKKwltZW1jcHkoZGF0YSAr
IFRJUENfQUVBRF9BTEdfTkFNRSArIHNpemVvZihfX2JlMzIpLCBza2V5LT5rZXksCisJICAgICAg
IHNrZXktPmtleWxlbik7CisKKwlfX3NrYl9xdWV1ZV9oZWFkX2luaXQoJnBrdHMpOworCV9fc2ti
X3F1ZXVlX3RhaWwoJnBrdHMsIHNrYik7CisJaWYgKGRub2RlKQorCQlyYyA9IHRpcGNfbm9kZV94
bWl0KG5ldCwgJnBrdHMsIGRub2RlLCAwKTsKKwllbHNlCisJCXJjID0gdGlwY19iY2FzdF94bWl0
KG5ldCwgJnBrdHMsICZjb25nX2xpbmtfY250KTsKKworCXJldHVybiByYzsKK30KKworLyoqCisg
KiB0aXBjX2NyeXB0b19rZXlfcmN2IC0gUmVjZWl2ZSBhIHNlc3Npb24ga2V5CisgKiBAcng6IHRo
ZSBSWCBjcnlwdG8KKyAqIEBoZHI6IHRoZSBUSVBDIHYyIG1lc3NhZ2UgaW5jbC4gdGhlIHJlY2Vp
dmluZyBzZXNzaW9uIGtleSBpbiBpdHMgZGF0YQorICoKKyAqIFRoaXMgZnVuY3Rpb24gcmV0cmll
dmVzIHRoZSBzZXNzaW9uIGtleSBpbiB0aGUgbWVzc2FnZSBmcm9tIHBlZXIsIHRoZW4KKyAqIHNj
aGVkdWxlcyBhIFJYIHdvcmsgdG8gYXR0YWNoIHRoZSBrZXkgdG8gdGhlIGNvcnJlc3BvbmRpbmcg
UlggY3J5cHRvLgorICoKKyAqIFJldHVybjogInRydWUiIGlmIHRoZSBrZXkgaGFzIGJlZW4gc2No
ZWR1bGVkIGZvciBhdHRhY2hpbmcsIG90aGVyd2lzZQorICogImZhbHNlIi4KKyAqLworc3RhdGlj
IGJvb2wgdGlwY19jcnlwdG9fa2V5X3JjdihzdHJ1Y3QgdGlwY19jcnlwdG8gKnJ4LCBzdHJ1Y3Qg
dGlwY19tc2cgKmhkcikKK3sKKwlzdHJ1Y3QgdGlwY19jcnlwdG8gKnR4ID0gdGlwY19uZXQocngt
Pm5ldCktPmNyeXB0b190eDsKKwlzdHJ1Y3QgdGlwY19hZWFkX2tleSAqc2tleSA9IE5VTEw7CisJ
dTE2IGtleV9nZW4gPSBtc2dfa2V5X2dlbihoZHIpOworCXUxNiBzaXplID0gbXNnX2RhdGFfc3oo
aGRyKTsKKwl1OCAqZGF0YSA9IG1zZ19kYXRhKGhkcik7CisKKwlzcGluX2xvY2soJnJ4LT5sb2Nr
KTsKKwlpZiAodW5saWtlbHkocngtPnNrZXkgfHwgKGtleV9nZW4gPT0gcngtPmtleV9nZW4gJiYg
cngtPmtleS5rZXlzKSkpIHsKKwkJcHJfZXJyKCIlczoga2V5IGV4aXN0ZWQgPCVweD4sIGdlbiAl
ZCB2cyAlZFxuIiwgcngtPm5hbWUsCisJCSAgICAgICByeC0+c2tleSwga2V5X2dlbiwgcngtPmtl
eV9nZW4pOworCQlnb3RvIGV4aXQ7CisJfQorCisJLyogQWxsb2NhdGUgbWVtb3J5IGZvciB0aGUg
a2V5ICovCisJc2tleSA9IGttYWxsb2Moc2l6ZSwgR0ZQX0FUT01JQyk7CisJaWYgKHVubGlrZWx5
KCFza2V5KSkgeworCQlwcl9lcnIoIiVzOiB1bmFibGUgdG8gYWxsb2NhdGUgbWVtb3J5IGZvciBz
a2V5XG4iLCByeC0+bmFtZSk7CisJCWdvdG8gZXhpdDsKKwl9CisKKwkvKiBDb3B5IGtleSBmcm9t
IG1zZyBkYXRhICovCisJc2tleS0+a2V5bGVuID0gbnRvaGwoKigoX19iZTMyKikoZGF0YSArIFRJ
UENfQUVBRF9BTEdfTkFNRSkpKTsKKwltZW1jcHkoc2tleS0+YWxnX25hbWUsIGRhdGEsIFRJUENf
QUVBRF9BTEdfTkFNRSk7CisJbWVtY3B5KHNrZXktPmtleSwgZGF0YSArIFRJUENfQUVBRF9BTEdf
TkFNRSArIHNpemVvZihfX2JlMzIpLAorCSAgICAgICBza2V5LT5rZXlsZW4pOworCisJLyogU2Fu
aXR5IGNoZWNrICovCisJaWYgKHVubGlrZWx5KHNpemUgIT0gdGlwY19hZWFkX2tleV9zaXplKHNr
ZXkpKSkgeworCQlrZnJlZShza2V5KTsKKwkJc2tleSA9IE5VTEw7CisJCWdvdG8gZXhpdDsKKwl9
CisKKwlyeC0+a2V5X2dlbiA9IGtleV9nZW47CisJcngtPnNrZXlfbW9kZSA9IG1zZ19rZXlfbW9k
ZShoZHIpOworCXJ4LT5za2V5ID0gc2tleTsKKwlyeC0+bm9rZXkgPSAwOworCW1iKCk7CisKK2V4
aXQ6CisJc3Bpbl91bmxvY2soJnJ4LT5sb2NrKTsKKworCS8qIFNjaGVkdWxlIHRoZSBrZXkgYXR0
YWNoaW5nIG9uIHRoaXMgY3J5cHRvICovCisJaWYgKGxpa2VseShza2V5ICYmIHF1ZXVlX2RlbGF5
ZWRfd29yayh0eC0+d3EsICZyeC0+d29yaywgMCkpKQorCQlyZXR1cm4gdHJ1ZTsKKworCXJldHVy
biBmYWxzZTsKK30KKworLyoqCisgKiB0aXBjX2NyeXB0b193b3JrX3J4IC0gU2NoZWR1bGVkIFJY
IHdvcmtzIGhhbmRsZXIKKyAqIEB3b3JrOiB0aGUgc3RydWN0IFJYIHdvcmsKKyAqCisgKiBUaGUg
ZnVuY3Rpb24gcHJvY2Vzc2VzIHRoZSBwcmV2aW91cyBzY2hlZHVsZWQgd29ya3MgaS5lLiBkaXN0
cmlidXRpbmcgVFgga2V5CisgKiBvciBhdHRhY2hpbmcgYSByZWNlaXZlZCBzZXNzaW9uIGtleSBv
biBSWCBjcnlwdG8uCisgKi8KK3N0YXRpYyB2b2lkIHRpcGNfY3J5cHRvX3dvcmtfcngoc3RydWN0
IHdvcmtfc3RydWN0ICp3b3JrKQoreworCXN0cnVjdCBkZWxheWVkX3dvcmsgKmR3b3JrID0gdG9f
ZGVsYXllZF93b3JrKHdvcmspOworCXN0cnVjdCB0aXBjX2NyeXB0byAqcnggPSBjb250YWluZXJf
b2YoZHdvcmssIHN0cnVjdCB0aXBjX2NyeXB0bywgd29yayk7CisJc3RydWN0IHRpcGNfY3J5cHRv
ICp0eCA9IHRpcGNfbmV0KHJ4LT5uZXQpLT5jcnlwdG9fdHg7CisJdW5zaWduZWQgbG9uZyBkZWxh
eSA9IG1zZWNzX3RvX2ppZmZpZXMoNTAwMCk7CisJYm9vbCByZXNjaGVkID0gZmFsc2U7CisJaW50
IHJjOworCisJLyogQ2FzZSAxOiBEaXN0cmlidXRlIFRYIGtleSB0byBwZWVyIGlmIHNjaGVkdWxl
ZCAqLworCWlmIChhdG9taWNfY21weGNoZygmcngtPmtleV9kaXN0ciwKKwkJCSAgIEtFWV9ESVNU
Ul9TQ0hFRCwKKwkJCSAgIEtFWV9ESVNUUl9DT01QTCkgPT0gS0VZX0RJU1RSX1NDSEVEKSB7CisJ
CS8qIEFsd2F5cyBwaWNrIHRoZSBuZXdlc3Qgb25lIGZvciBkaXN0cmlidXRpbmcgKi8KKwkJdGlw
Y19jcnlwdG9fa2V5X2Rpc3RyKHR4LAorCQkJCSAgICAgIHR4LT5rZXkucGVuZGluZyA/OiB0eC0+
a2V5LmFjdGl2ZSwKKwkJCQkgICAgICByeC0+bm9kZSk7CisJCS8qIFNjaGVkIGZvciBrZXlfZGlz
dHIgcmVsZWFzaW5nICovCisJCXJlc2NoZWQgPSB0cnVlOworCX0gZWxzZSB7CisJCWF0b21pY19j
bXB4Y2hnKCZyeC0+a2V5X2Rpc3RyLCBLRVlfRElTVFJfQ09NUEwsIDApOworCX0KKworCS8qIENh
c2UgMjogQXR0YWNoIGEgcGVuZGluZyByZWNlaXZlZCBzZXNzaW9uIGtleSBmcm9tIHBlZXIgaWYg
YW55ICovCisJaWYgKHJ4LT5za2V5KSB7CisJCXJjID0gdGlwY19jcnlwdG9fa2V5X2luaXQocngs
IHJ4LT5za2V5LCByeC0+c2tleV9tb2RlLCBmYWxzZSk7CisJCXN3aXRjaCAocmMpIHsKKwkJY2Fz
ZSAtRUJVU1k6CisJCWNhc2UgLUVOT01FTToKKwkJCS8qIFJlc2NoZWQgdGhlIGtleSBhdHRhY2hp
bmcgKi8KKwkJCXJlc2NoZWQgPSB0cnVlOworCQkJYnJlYWs7CisJCWRlZmF1bHQ6CisJCQlzeW5j
aHJvbml6ZV9yY3UoKTsKKwkJCWtmcmVlKHJ4LT5za2V5KTsKKwkJCXJ4LT5za2V5ID0gTlVMTDsK
KwkJfQorCX0KKworCWlmIChyZXNjaGVkICYmIHF1ZXVlX2RlbGF5ZWRfd29yayh0eC0+d3EsICZy
eC0+d29yaywgZGVsYXkpKQorCQlyZXR1cm47CisKKwl0aXBjX25vZGVfcHV0KHJ4LT5ub2RlKTsK
K30KZGlmZiAtLWdpdCBhL25ldC90aXBjL2NyeXB0by5oIGIvbmV0L3RpcGMvY3J5cHRvLmgKaW5k
ZXggN2ZjYjgwY2IwZThhLi43MGJkYTNkN2UxNzQgMTAwNjQ0Ci0tLSBhL25ldC90aXBjL2NyeXB0
by5oCisrKyBiL25ldC90aXBjL2NyeXB0by5oCkBAIC02Nyw2ICs2Nyw3IEBAIGVudW0gewogIH07
CiAgCiAgZXh0ZXJuIGludCBzeXNjdGxfdGlwY19tYXhfdGZtcyBfX3JlYWRfbW9zdGx5OworZXh0
ZXJuIGludCBzeXNjdGxfdGlwY19rZXlfZXhjaGFuZ2VfZW5hYmxlZCBfX3JlYWRfbW9zdGx5Owog
IAogIC8qKgogICAqIFRJUEMgZW5jcnlwdGlvbiBtZXNzYWdlIGZvcm1hdDoKQEAgLTE2Nyw4ICsx
NjgsMzEgQEAgaW50IHRpcGNfY3J5cHRvX3JjdihzdHJ1Y3QgbmV0ICpuZXQsIHN0cnVjdCB0aXBj
X2NyeXB0byAqcngsCiAgaW50IHRpcGNfY3J5cHRvX2tleV9pbml0KHN0cnVjdCB0aXBjX2NyeXB0
byAqYywgc3RydWN0IHRpcGNfYWVhZF9rZXkgKnVrZXksCiAgCQkJIHU4IG1vZGUsIGJvb2wgbWFz
dGVyX2tleSk7CiAgdm9pZCB0aXBjX2NyeXB0b19rZXlfZmx1c2goc3RydWN0IHRpcGNfY3J5cHRv
ICpjKTsKK2ludCB0aXBjX2NyeXB0b19rZXlfZGlzdHIoc3RydWN0IHRpcGNfY3J5cHRvICp0eCwg
dTgga2V5LAorCQkJICBzdHJ1Y3QgdGlwY19ub2RlICpkZXN0KTsKK3ZvaWQgdGlwY19jcnlwdG9f
bXNnX3JjdihzdHJ1Y3QgbmV0ICpuZXQsIHN0cnVjdCBza19idWZmICpza2IpOwogIGludCB0aXBj
X2FlYWRfa2V5X3ZhbGlkYXRlKHN0cnVjdCB0aXBjX2FlYWRfa2V5ICp1a2V5KTsKICBib29sIHRp
cGNfZWhkcl92YWxpZGF0ZShzdHJ1Y3Qgc2tfYnVmZiAqc2tiKTsKICAKK3N0YXRpYyBpbmxpbmUg
dTMyIG1zZ19rZXlfZ2VuKHN0cnVjdCB0aXBjX21zZyAqbSkKK3sKKwlyZXR1cm4gbXNnX2JpdHMo
bSwgNCwgMTYsIDB4ZmZmZik7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBtc2dfc2V0X2tleV9n
ZW4oc3RydWN0IHRpcGNfbXNnICptLCB1MzIgZ2VuKQoreworCW1zZ19zZXRfYml0cyhtLCA0LCAx
NiwgMHhmZmZmLCBnZW4pOworfQorCitzdGF0aWMgaW5saW5lIHUzMiBtc2dfa2V5X21vZGUoc3Ry
dWN0IHRpcGNfbXNnICptKQoreworCXJldHVybiBtc2dfYml0cyhtLCA0LCAwLCAweGYpOworfQor
CitzdGF0aWMgaW5saW5lIHZvaWQgbXNnX3NldF9rZXlfbW9kZShzdHJ1Y3QgdGlwY19tc2cgKm0s
IHUzMiBtb2RlKQoreworCW1zZ19zZXRfYml0cyhtLCA0LCAwLCAweGYsIG1vZGUpOworfQorCiAg
I2VuZGlmIC8qIF9USVBDX0NSWVBUT19IICovCiAgI2VuZGlmCmRpZmYgLS1naXQgYS9uZXQvdGlw
Yy9saW5rLmMgYi9uZXQvdGlwYy9saW5rLmMKaW5kZXggMWM1NzkzNTdjY2RmLi45MTQyZTI2NGYw
MjAgMTAwNjQ0Ci0tLSBhL25ldC90aXBjL2xpbmsuYworKysgYi9uZXQvdGlwYy9saW5rLmMKQEAg
LTEyNDQsNiArMTI0NCwxMSBAQCBzdGF0aWMgYm9vbCB0aXBjX2RhdGFfaW5wdXQoc3RydWN0IHRp
cGNfbGluayAqbCwgc3RydWN0IHNrX2J1ZmYgKnNrYiwKICAJY2FzZSBNU0dfRlJBR01FTlRFUjoK
ICAJY2FzZSBCQ0FTVF9QUk9UT0NPTDoKICAJCXJldHVybiBmYWxzZTsKKyNpZmRlZiBDT05GSUdf
VElQQ19DUllQVE8KKwljYXNlIE1TR19DUllQVE86CisJCXRpcGNfY3J5cHRvX21zZ19yY3YobC0+
bmV0LCBza2IpOworCQlyZXR1cm4gdHJ1ZTsKKyNlbmRpZgogIAlkZWZhdWx0OgogIAkJcHJfd2Fy
bigiRHJvcHBpbmcgcmVjZWl2ZWQgaWxsZWdhbCBtc2cgdHlwZVxuIik7CiAgCQlrZnJlZV9za2Io
c2tiKTsKZGlmZiAtLWdpdCBhL25ldC90aXBjL21zZy5oIGIvbmV0L3RpcGMvbXNnLmgKaW5kZXgg
MjVlNWM1YzhhNmZmLi4yYjUxNGM2MDBjMmQgMTAwNjQ0Ci0tLSBhL25ldC90aXBjL21zZy5oCisr
KyBiL25ldC90aXBjL21zZy5oCkBAIC04Miw2ICs4Miw3IEBAIHN0cnVjdCBwbGlzdDsKICAjZGVm
aW5lICBOQU1FX0RJU1RSSUJVVE9SICAgICAxMQogICNkZWZpbmUgIE1TR19GUkFHTUVOVEVSICAg
ICAgIDEyCiAgI2RlZmluZSAgTElOS19DT05GSUcgICAgICAgICAgMTMKKyNkZWZpbmUgIE1TR19D
UllQVE8gICAgICAgICAgIDE0CiAgI2RlZmluZSAgU09DS19XQUtFVVAgICAgICAgICAgMTQgICAg
ICAgLyogcHNldWRvIHVzZXIgKi8KICAjZGVmaW5lICBUT1BfU1JWICAgICAgICAgICAgICAxNSAg
ICAgICAvKiBwc2V1ZG8gdXNlciAqLwogIApAQCAtNzUwLDYgKzc1MSwxMSBAQCBzdGF0aWMgaW5s
aW5lIHZvaWQgbXNnX3NldF9uYW1ldXBwZXIoc3RydWN0IHRpcGNfbXNnICptLCB1MzIgbikKICAj
ZGVmaW5lIEdSUF9SRU1JVF9NU0cgICAgICAgIDUKICAKICAvKgorICogQ3J5cHRvIG1lc3NhZ2Ug
dHlwZXMKKyAqLworI2RlZmluZSBLRVlfRElTVFJfTVNHCQkwCisKKy8qCiAgICogV29yZCAxCiAg
ICovCiAgc3RhdGljIGlubGluZSB1MzIgbXNnX3NlcV9nYXAoc3RydWN0IHRpcGNfbXNnICptKQpk
aWZmIC0tZ2l0IGEvbmV0L3RpcGMvbm9kZS5jIGIvbmV0L3RpcGMvbm9kZS5jCmluZGV4IDU1ZjAx
MmQxZWE3NC4uMTg2OTUxYjY5MGQyIDEwMDY0NAotLS0gYS9uZXQvdGlwYy9ub2RlLmMKKysrIGIv
bmV0L3RpcGMvbm9kZS5jCkBAIC0yNzgsNiArMjc4LDE0IEBAIHN0cnVjdCB0aXBjX2NyeXB0byAq
dGlwY19ub2RlX2NyeXB0b19yeF9ieV9saXN0KHN0cnVjdCBsaXN0X2hlYWQgKnBvcykKICB7CiAg
CXJldHVybiBjb250YWluZXJfb2YocG9zLCBzdHJ1Y3QgdGlwY19ub2RlLCBsaXN0KS0+Y3J5cHRv
X3J4OwogIH0KKworc3RydWN0IHRpcGNfY3J5cHRvICp0aXBjX25vZGVfY3J5cHRvX3J4X2J5X2Fk
ZHIoc3RydWN0IG5ldCAqbmV0LCB1MzIgYWRkcikKK3sKKwlzdHJ1Y3QgdGlwY19ub2RlICpuOwor
CisJbiA9IHRpcGNfbm9kZV9maW5kKG5ldCwgYWRkcik7CisJcmV0dXJuIChuKSA/IG4tPmNyeXB0
b19yeCA6IE5VTEw7Cit9CiAgI2VuZGlmCiAgCiAgc3RhdGljIHZvaWQgdGlwY19ub2RlX2ZyZWUo
c3RydWN0IHJjdV9oZWFkICpycCkKQEAgLTMwMyw3ICszMTEsNyBAQCB2b2lkIHRpcGNfbm9kZV9w
dXQoc3RydWN0IHRpcGNfbm9kZSAqbm9kZSkKICAJa3JlZl9wdXQoJm5vZGUtPmtyZWYsIHRpcGNf
bm9kZV9rcmVmX3JlbGVhc2UpOwogIH0KICAKLXN0YXRpYyB2b2lkIHRpcGNfbm9kZV9nZXQoc3Ry
dWN0IHRpcGNfbm9kZSAqbm9kZSkKK3ZvaWQgdGlwY19ub2RlX2dldChzdHJ1Y3QgdGlwY19ub2Rl
ICpub2RlKQogIHsKICAJa3JlZl9nZXQoJm5vZGUtPmtyZWYpOwogIH0KQEAgLTU4NCw2ICs1OTIs
NyBAQCBzdGF0aWMgdm9pZCB0aXBjX25vZGVfY2FsY3VsYXRlX3RpbWVyKHN0cnVjdCB0aXBjX25v
ZGUgKm4sIHN0cnVjdCB0aXBjX2xpbmsgKmwpCiAgCiAgc3RhdGljIHZvaWQgdGlwY19ub2RlX2Rl
bGV0ZV9mcm9tX2xpc3Qoc3RydWN0IHRpcGNfbm9kZSAqbm9kZSkKICB7CisJdGlwY19jcnlwdG9f
a2V5X2ZsdXNoKG5vZGUtPmNyeXB0b19yeCk7CiAgCWxpc3RfZGVsX3JjdSgmbm9kZS0+bGlzdCk7
CiAgCWhsaXN0X2RlbF9yY3UoJm5vZGUtPmhhc2gpOwogIAl0aXBjX25vZGVfcHV0KG5vZGUpOwpA
QCAtMjkyMiw2ICsyOTMxLDE0IEBAIHN0YXRpYyBpbnQgX190aXBjX25sX25vZGVfc2V0X2tleShz
dHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgZ2VubF9pbmZvICppbmZvKQogIAogIAkvKiBJbml0
aWF0ZSB0aGUgVFgvUlgga2V5ICovCiAgCXJjID0gdGlwY19jcnlwdG9fa2V5X2luaXQoYywgdWtl
eSwgbW9kZSwgbWFzdGVyX2tleSk7CisJaWYgKHJjIDwgMCB8fCBjICE9IHR4KQorCQlnb3RvIGV4
aXQ7CisKKwkvKiBEaXN0cmlidXRlIFRYIGtleSBidXQgbm90IG1hc3RlciBvbmUgKi8KKwlpZiAo
IW1hc3Rlcl9rZXkpCisJCXRpcGNfY3J5cHRvX2tleV9kaXN0cih0eCwgcmMsIE5VTEwpOworCitl
eGl0OgogIAlpZiAobikKICAJCXRpcGNfbm9kZV9wdXQobik7CiAgCmRpZmYgLS1naXQgYS9uZXQv
dGlwYy9ub2RlLmggYi9uZXQvdGlwYy9ub2RlLmgKaW5kZXggOWY2ZjEzZjE2MDRmLi4xNTRhNWJi
YjBkMjkgMTAwNjQ0Ci0tLSBhL25ldC90aXBjL25vZGUuaAorKysgYi9uZXQvdGlwYy9ub2RlLmgK
QEAgLTc5LDEyICs3OSwxNCBAQCBib29sIHRpcGNfbm9kZV9nZXRfaWQoc3RydWN0IG5ldCAqbmV0
LCB1MzIgYWRkciwgdTggKmlkKTsKICB1MzIgdGlwY19ub2RlX2dldF9hZGRyKHN0cnVjdCB0aXBj
X25vZGUgKm5vZGUpOwogIGNoYXIgKnRpcGNfbm9kZV9nZXRfaWRfc3RyKHN0cnVjdCB0aXBjX25v
ZGUgKm5vZGUpOwogIHZvaWQgdGlwY19ub2RlX3B1dChzdHJ1Y3QgdGlwY19ub2RlICpub2RlKTsK
K3ZvaWQgdGlwY19ub2RlX2dldChzdHJ1Y3QgdGlwY19ub2RlICpub2RlKTsKICBzdHJ1Y3QgdGlw
Y19ub2RlICp0aXBjX25vZGVfY3JlYXRlKHN0cnVjdCBuZXQgKm5ldCwgdTMyIGFkZHIsIHU4ICpw
ZWVyX2lkLAogIAkJCQkgICB1MTYgY2FwYWJpbGl0aWVzLCB1MzIgaGFzaF9taXhlcywKICAJCQkJ
ICAgYm9vbCBwcmVsaW1pbmFyeSk7CiAgI2lmZGVmIENPTkZJR19USVBDX0NSWVBUTwogIHN0cnVj
dCB0aXBjX2NyeXB0byAqdGlwY19ub2RlX2NyeXB0b19yeChzdHJ1Y3QgdGlwY19ub2RlICpfX24p
OwogIHN0cnVjdCB0aXBjX2NyeXB0byAqdGlwY19ub2RlX2NyeXB0b19yeF9ieV9saXN0KHN0cnVj
dCBsaXN0X2hlYWQgKnBvcyk7CitzdHJ1Y3QgdGlwY19jcnlwdG8gKnRpcGNfbm9kZV9jcnlwdG9f
cnhfYnlfYWRkcihzdHJ1Y3QgbmV0ICpuZXQsIHUzMiBhZGRyKTsKICAjZW5kaWYKICB1MzIgdGlw
Y19ub2RlX3RyeV9hZGRyKHN0cnVjdCBuZXQgKm5ldCwgdTggKmlkLCB1MzIgYWRkcik7CiAgdm9p
ZCB0aXBjX25vZGVfY2hlY2tfZGVzdChzdHJ1Y3QgbmV0ICpuZXQsIHUzMiBvbm9kZSwgdTggKnBl
ZXJfaWQxMjgsCmRpZmYgLS1naXQgYS9uZXQvdGlwYy9zeXNjdGwuYyBiL25ldC90aXBjL3N5c2N0
bC5jCmluZGV4IDk3YTYyNjRhMjk5My4uOWZiNjVjOTg4ZjdmIDEwMDY0NAotLS0gYS9uZXQvdGlw
Yy9zeXNjdGwuYworKysgYi9uZXQvdGlwYy9zeXNjdGwuYwpAQCAtNzQsNiArNzQsMTUgQEAgc3Rh
dGljIHN0cnVjdCBjdGxfdGFibGUgdGlwY190YWJsZVtdID0gewogIAkJLnByb2NfaGFuZGxlcgk9
IHByb2NfZG9pbnR2ZWNfbWlubWF4LAogIAkJLmV4dHJhMSAgICAgICAgID0gU1lTQ1RMX09ORSwK
ICAJfSwKKwl7CisJCS5wcm9jbmFtZQk9ICJrZXlfZXhjaGFuZ2VfZW5hYmxlZCIsCisJCS5kYXRh
CQk9ICZzeXNjdGxfdGlwY19rZXlfZXhjaGFuZ2VfZW5hYmxlZCwKKwkJLm1heGxlbgkJPSBzaXpl
b2Yoc3lzY3RsX3RpcGNfa2V5X2V4Y2hhbmdlX2VuYWJsZWQpLAorCQkubW9kZQkJPSAwNjQ0LAor
CQkucHJvY19oYW5kbGVyCT0gcHJvY19kb2ludHZlY19taW5tYXgsCisJCS5leHRyYTEgICAgICAg
ICA9IFNZU0NUTF9aRVJPLAorCQkuZXh0cmEyICAgICAgICAgPSBTWVNDVExfT05FLAorCX0sCiAg
I2VuZGlmCiAgCXsKICAJCS5wcm9jbmFtZQk9ICJiY19yZXRydW5pIiwKCldpdGggc29tZSBjbGFy
aWZpY2F0aW9ucyBhcyBwZXIgY29tbWVudHMgYWJvdmU6CgpBY2tlZC1ieTogSm9uIE1hbG95IDxq
bWFsb3lAcmVkaGF0LmNvbT4KCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KdGlwYy1kaXNjdXNzaW9uIG1haWxpbmcgbGlzdAp0aXBjLWRpc2N1c3Npb25A
bGlzdHMuc291cmNlZm9yZ2UubmV0Cmh0dHBzOi8vbGlzdHMuc291cmNlZm9yZ2UubmV0L2xpc3Rz
L2xpc3RpbmZvL3RpcGMtZGlzY3Vzc2lvbgo=
