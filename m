Return-Path: <tipc-discussion-bounces@lists.sourceforge.net>
X-Original-To: lists+tipc-discussion@lfdr.de
Delivered-To: lists+tipc-discussion@lfdr.de
Received: from lists.sourceforge.net (lists.sourceforge.net [216.105.38.7])
	by mail.lfdr.de (Postfix) with ESMTPS id 57BA5227D9E
	for <lists+tipc-discussion@lfdr.de>; Tue, 21 Jul 2020 12:50:39 +0200 (CEST)
Received: from [127.0.0.1] (helo=sfs-ml-2.v29.lw.sourceforge.com)
	by sfs-ml-2.v29.lw.sourceforge.com with esmtp (Exim 4.90_1)
	(envelope-from <tipc-discussion-bounces@lists.sourceforge.net>)
	id 1jxpqz-0005fF-2k; Tue, 21 Jul 2020 10:50:33 +0000
Received: from [172.30.20.202] (helo=mx.sourceforge.net)
 by sfs-ml-2.v29.lw.sourceforge.com with esmtps
 (TLSv1.2:ECDHE-RSA-AES256-GCM-SHA384:256) (Exim 4.90_1)
 (envelope-from <tuong.t.lien@dektech.com.au>) id 1jxpqw-0005f0-7l
 for tipc-discussion@lists.sourceforge.net; Tue, 21 Jul 2020 10:50:30 +0000
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
 d=sourceforge.net; s=x; h=MIME-Version:Content-Transfer-Encoding:Content-Type
 :In-Reply-To:References:Message-ID:Date:Subject:CC:To:From:Sender:Reply-To:
 Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:
 Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:
 List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=VAO6H4u0NoSmPigBViTKseR+/KiID/jNn75iU5Qjm54=; b=DT+bbDSxOi881nscQ0Kx/pAfck
 8IRop3fvD213iAMBMPBUSLTAB2Ngeoux88vI6cpTnW5au52rLOAXfuli1dP5IE8Ao3ZHeeSWCY3B7
 xld/Xg23aAOLfQ1jzSlGEXIcr5dr0fo54KgiMMtZGl7tGKW0JqW7JAVJDmWHpHV0eSEI=;
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=sf.net; s=x
 ;
 h=MIME-Version:Content-Transfer-Encoding:Content-Type:In-Reply-To:
 References:Message-ID:Date:Subject:CC:To:From:Sender:Reply-To:Content-ID:
 Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc
 :Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:List-Subscribe:
 List-Post:List-Owner:List-Archive;
 bh=VAO6H4u0NoSmPigBViTKseR+/KiID/jNn75iU5Qjm54=; b=QPUwQKohyYvLgTaZRZzlFu//fI
 1r9bESmOIE/uHSyDUbN/6t9nMFGDUosJMcH/J0ibEGKY2vSVcUpOxNOtQnmXa4XfZcwrWYH4xiXEg
 WbNjs0Gyh/aBvLKQzh6F+yNND4yX+RtbEPUNmThPfV55qM+DWOJDqvQdTLUnNcRFHK7A=;
Received: from mail-eopbgr10099.outbound.protection.outlook.com ([40.107.1.99]
 helo=EUR02-HE1-obe.outbound.protection.outlook.com)
 by sfi-mx-1.v28.lw.sourceforge.com with esmtps
 (TLSv1.2:ECDHE-RSA-AES256-GCM-SHA384:256) (Exim 4.92.2)
 id 1jxpqn-002tqh-R2
 for tipc-discussion@lists.sourceforge.net; Tue, 21 Jul 2020 10:50:30 +0000
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=ImzOSadJIkL62vYL9RJskVKXZZT5JF+nV37e6wN8mexduvdY/7HJMcVQp6Jm3XtECwEyziePbYMiOqDzcSzPo+RIpOgWELKH6NbytaLsSGBtFxnUuwtEveQTGwlRFdLOJRjsiVaW6DZuaXMxVxY/nMHQ+Y+ZbMpI/mQ4RCgU7vziCzVFASg2tSmH95WLdfMsAUcJhtdRZL0jcQCs9FjWoE6sDVNYdUzNIJ0EcQH02mQlw3RICRKYC4/2F0AV5G6McQD9ZbbWsBwx/ZYdy7uk9KtLh+V+9DkzGVSu0vLsFdgKggNXdgQpN0KiYEwoSCiUE0bz8aRoY1m9NG4IoJUSAw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com; 
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=VAO6H4u0NoSmPigBViTKseR+/KiID/jNn75iU5Qjm54=;
 b=dfm+vwKdD+UdFFT7hlJchjUYuzQRjh/kRSLe7ItdBz25kDypaBQRBBrzf6XgVxPWdtkDqkjn7LVvQrn+TCw1LyE4KU5sulErjC3ifDqO3LWEHwHBBclW9v+jS7BVbXNW9XDV2Pt9e/uf58mpABpkHGek5bWeLtmJEYt8xmPss30najpNiLZdkDNPFUmXiXNOEqLESKItRMjdVNTgpoMVi/hLpsjLnERjd7nfJBHMuuKddyuFipCe7QgpPZ//3aqlQuVQ1OEoRE6OxgPBuYseUSlHs9MhEYE5a44mnLdOEfL9r69SvcjdZK+daYjFP1qeeqPZ9GDynU2O6fmZwOBrcw==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=dektech.com.au; dmarc=pass action=none
 header.from=dektech.com.au; dkim=pass header.d=dektech.com.au; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=dektech.com.au;
 s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=VAO6H4u0NoSmPigBViTKseR+/KiID/jNn75iU5Qjm54=;
 b=vuT8YZMUm1p+eMo1mt8tY316JAvJvRSxOsnO9k9GROARB8AedAtUK71gpbg/dQF9wHQjOw199JGsacrNt+bd0gxa0yjPzneeyVqJ6PnQo/i5Nrgcl5hm4B7BYDZVOPryl5W5MMfDEFf/1/TfEQMKsi6Wtid/ET9ZY2a5eXT3/6E=
Received: from AM6PR0502MB3925.eurprd05.prod.outlook.com (2603:10a6:209:5::28)
 by AM7PR05MB6664.eurprd05.prod.outlook.com (2603:10a6:20b:141::18)
 with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.3195.17; Tue, 21 Jul
 2020 10:33:53 +0000
Received: from AM6PR0502MB3925.eurprd05.prod.outlook.com
 ([fe80::9d1c:861f:f91e:7e5d]) by AM6PR0502MB3925.eurprd05.prod.outlook.com
 ([fe80::9d1c:861f:f91e:7e5d%7]) with mapi id 15.20.3195.026; Tue, 21 Jul 2020
 10:33:53 +0000
From: Tuong Tong Lien <tuong.t.lien@dektech.com.au>
To: Jon Maloy <jmaloy@redhat.com>, "maloy@donjonn.com" <maloy@donjonn.com>,
 "ying.xue@windriver.com" <ying.xue@windriver.com>,
 "tipc-discussion@lists.sourceforge.net"
 <tipc-discussion@lists.sourceforge.net>
Thread-Topic: [PATCH RFC 3/5] tipc: introduce encryption master key
Thread-Index: AQHWVqKCE1hKlukEOEqRJ+dgSQL1TakQ08eAgAESD6A=
Date: Tue, 21 Jul 2020 10:33:53 +0000
Message-ID: <AM6PR0502MB39252D0DB2DD156E3F64AF3DE2780@AM6PR0502MB3925.eurprd05.prod.outlook.com>
References: <20200710101128.19713-1-tuong.t.lien@dektech.com.au>
 <20200710101128.19713-4-tuong.t.lien@dektech.com.au>
 <18eadc23-584a-3f26-2976-456e2d3d26f9@redhat.com>
In-Reply-To: <18eadc23-584a-3f26-2976-456e2d3d26f9@redhat.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: redhat.com; dkim=none (message not signed)
 header.d=none;redhat.com; dmarc=none action=none header.from=dektech.com.au;
x-originating-ip: [14.161.14.188]
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 4f1368d4-7084-439a-5d8d-08d82d6190e4
x-ms-traffictypediagnostic: AM7PR05MB6664:
x-ms-exchange-transport-forked: True
x-microsoft-antispam-prvs: <AM7PR05MB6664631962B7EE597A7BDA32E2780@AM7PR05MB6664.eurprd05.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:227;
x-ms-exchange-senderadcheck: 1
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: AacqDW/3XeJiBejiGFEL3bjzTVu3M16dWTpsuzESakLKa9LcFlH9GzQFGTvtqGHTkV49KWKEZ7s5ZZeK0OH3pdqdwdaYVggZfN2t3SDwi0R1+05MdyqNkiYL+mLdkKfvtnPOjzA5854oyUtfsCdIaHGkaGU3K4Gr9V08g1LuK8zGKKp2G+dhQGrd36K+y/mOaOQJFn6Z+1kGzm9YiGZ/PS+Ao/NTraZaZ21jNmRTvzhx59pkQ13NOFYIUQESFJ98fx0hMAkrfKZ6fswi1Hmb4XosRjhM30qEifL8SsYR2Of/fSVVDQwRTrY4JIpOEUh1xpwo0g/G5S7FeXzqJqbWlWbMZul7DUO14IM0v4A2ueMSRjLojsXZiF1rOniG9ANqB5Hmv+sqe4eAm1luctijcg==
x-forefront-antispam-report: CIP:255.255.255.255; CTRY:; LANG:en; SCL:1; SRV:;
 IPV:NLI; SFV:NSPM; H:AM6PR0502MB3925.eurprd05.prod.outlook.com; PTR:; CAT:NONE;
 SFTY:;
 SFS:(396003)(39850400004)(136003)(366004)(376002)(346002)(86362001)(107886003)(316002)(9686003)(30864003)(66446008)(71200400001)(52536014)(4326008)(83380400001)(2906002)(64756008)(66556008)(66476007)(66946007)(508600001)(55016002)(8676002)(5660300002)(7696005)(26005)(966005)(33656002)(53546011)(6506007)(110136005)(76116006)(8936002)(186003)(579004)(559001);
 DIR:OUT; SFP:1102; 
x-ms-exchange-antispam-messagedata: eDrUnN+AFcEcA99i68wj1QFrN8IzIxgEk8az7GF2lAizmkEoZSEFpqaeMYAS7Hgas7Ad8hxO1hY2JpDha42E6iHA0PXUE/iSdJOWAe7cSUAr7/u5dc628Njlf5ChVvQvxedId0E4CFVkSr4dGrQn5UCRjoM+Bghcr56+HaPXYSnQutOzXSp/mGV+FZMnNcjdvx3mkKR2qp2ufNP+CPR+nVUc9icumeNBVFJyL/PyqtXyK7RPkSIhUoxE5BusIXdoKHVeelYISSbRxCAfhuwYjt0nJ22yhn7lcYgrjB3Kh7Q/eXxyMZFl4+2TDFMK/OQm+AXuF4qESha3DVKxqqMRfyBMaWJ82haVwxZNRe5aKyqrn8YUA12/EXEVHwDIZnh9ROdHXhHp8M2jDM7Vtyle1A11KdppHVGW/2CMPAjNimHVu9/m7ahlgFeQDq5Rb/hcgx4zf9zIq8JZJ1p3Uqm2N/NdFaqReYaXg4xINCTxirU=
MIME-Version: 1.0
X-OriginatorOrg: dektech.com.au
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: AM6PR0502MB3925.eurprd05.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 4f1368d4-7084-439a-5d8d-08d82d6190e4
X-MS-Exchange-CrossTenant-originalarrivaltime: 21 Jul 2020 10:33:53.8068 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 1957ea50-0dd8-4360-8db0-c9530df996b2
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: QyaiX50/Z3R3dTOROnOIDXL5JbUqAx0jWu2tgGzSgpA6dk35nYQr/AchDsPHShIXfJGfO1kMKhihbetucV0oaINZbigtnM+7MdRWFMT3gCQ=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: AM7PR05MB6664
X-Spam-Score: -0.1 (/)
X-Spam-Report: Spam Filtering performed by mx.sourceforge.net.
 See http://spamassassin.org/tag/ for more details.
 0.0 URIBL_BLOCKED ADMINISTRATOR NOTICE: The query to URIBL was blocked.
 See
 http://wiki.apache.org/spamassassin/DnsBlocklists#dnsbl-block
 for more information. [URIs: wikipedia.org]
 -0.0 RCVD_IN_MSPIKE_H2      RBL: Average reputation (+2)
 [40.107.1.99 listed in wl.mailspike.net]
 -0.0 SPF_HELO_PASS          SPF: HELO matches SPF record
 -0.0 SPF_PASS               SPF: sender matches SPF record
 -0.1 DKIM_VALID_AU Message has a valid DKIM or DK signature from author's
 domain
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature,
 not necessarily valid
X-Headers-End: 1jxpqn-002tqh-R2
Subject: Re: [tipc-discussion] [PATCH RFC 3/5] tipc: introduce encryption
 master key
X-BeenThere: tipc-discussion@lists.sourceforge.net
X-Mailman-Version: 2.1.21
Precedence: list
List-Id: <tipc-discussion.lists.sourceforge.net>
List-Unsubscribe: <https://lists.sourceforge.net/lists/options/tipc-discussion>, 
 <mailto:tipc-discussion-request@lists.sourceforge.net?subject=unsubscribe>
List-Archive: <http://sourceforge.net/mailarchive/forum.php?forum_name=tipc-discussion>
List-Post: <mailto:tipc-discussion@lists.sourceforge.net>
List-Help: <mailto:tipc-discussion-request@lists.sourceforge.net?subject=help>
List-Subscribe: <https://lists.sourceforge.net/lists/listinfo/tipc-discussion>, 
 <mailto:tipc-discussion-request@lists.sourceforge.net?subject=subscribe>
Cc: tipc-dek <tipc-dek@dektech.com.au>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: tipc-discussion-bounces@lists.sourceforge.net

SGkgSm9uLA0KDQpUaGFua3MgYSBsb3QgZm9yIHlvdXIgY29tbWVudHMsIEkgd2lsbCB1cGRhdGUg
dGhlbSBhY2NvcmRpbmdseSENClJlZ2FyZGluZyB0aGUgJ21hc3RlciBrZXknIGRlZmluaXRpb24s
IEkgaGF2ZSBqdXN0IGRvbmUgYSBzZWFyY2ggYW5kIGZvdW5kIGl0IHRvIHBlcmZlY3RseSBtYXRj
aGVkIG91ciBjYXNlOg0KDQotLS0tLS0tLS0tLS0tLQ0KaHR0cHM6Ly9lbi53aWtpcGVkaWEub3Jn
L3dpa2kvQ3J5cHRvZ3JhcGhpY19rZXlfdHlwZXMNClN5bW1ldHJpYyBtYXN0ZXIga2V5DQogICAg
QSBzeW1tZXRyaWMgbWFzdGVyIGtleSBpcyB1c2VkIHRvIGRlcml2ZSBvdGhlciBzeW1tZXRyaWMg
a2V5cyAoZS5nLiwgZGF0YSBlbmNyeXB0aW9uIGtleXMsIGtleSB3cmFwcGluZyBrZXlzLCBvciBh
dXRoZW50aWNhdGlvbiBrZXlzKSB1c2luZyBzeW1tZXRyaWMgY3J5cHRvZ3JhcGhpYyBtZXRob2Rz
Lg0KLS0tLS0tLS0tLS0tLS0NCg0KSSB0aGluayBpdCBpcyBmaW5lIHRvIGdvIHdpdGggaXQsIG9m
IGNvdXJzZSB1bmxlc3Mgd2UgZmluZCBhIGJldHRlciBvbmUuLi4g8J+YiiENCg0KQlIvVHVvbmcN
Cg0KLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCkZyb206IEpvbiBNYWxveSA8am1hbG95QHJl
ZGhhdC5jb20+IA0KU2VudDogVHVlc2RheSwgSnVseSAyMSwgMjAyMCAxOjA3IEFNDQpUbzogVHVv
bmcgVG9uZyBMaWVuIDx0dW9uZy50LmxpZW5AZGVrdGVjaC5jb20uYXU+OyBtYWxveUBkb25qb25u
LmNvbTsgeWluZy54dWVAd2luZHJpdmVyLmNvbTsgdGlwYy1kaXNjdXNzaW9uQGxpc3RzLnNvdXJj
ZWZvcmdlLm5ldA0KQ2M6IHRpcGMtZGVrIDx0aXBjLWRla0BkZWt0ZWNoLmNvbS5hdT4NClN1Ympl
Y3Q6IFJlOiBbUEFUQ0ggUkZDIDMvNV0gdGlwYzogaW50cm9kdWNlIGVuY3J5cHRpb24gbWFzdGVy
IGtleQ0KDQoNCg0KT24gNy8xMC8yMCA2OjExIEFNLCBUdW9uZyBMaWVuIHdyb3RlOg0KPiBJbiBh
ZGRpdGlvbiB0byB0aGUgc3VwcG9ydGVkIGNsdXN0ZXIgJiBwZXItbm9kZSBlbmNyeXB0aW9uIGtl
eXMgZm9yIHRoZQ0KPiBlbi9kZWNyeXB0aW9uIG9mIFRJUEMgbWVzc2FnZXMsIHdlIG5vdyBpbnRy
b2R1Y2Ugb25lIG9wdGlvbiBmb3IgdXNlciB0bw0KPiBzZXQgYSBjbHVzdGVyIGtleSBhcyAnbWFz
dGVyIGtleScsDQpTdGlsbCBub3QgcXVpdGUgaGFwcHkgd2l0aCB0aGUgdGVybSAnbWFzdGVyIGtl
eScgYnV0IGhhdmUgbm8gcmVhbGx5IGdvb2QgDQpzdWdnZXN0aW9ucyBhdCB0aGUgbW9tZW50Lg0K
TWF5YmUgJ21lbWJlcnNoaXAga2V5JyBvciBqdXN0ICdtZW1iZXIga2V5Jz8NCj4gd2hpY2ggaXMg
c2ltcGx5IGEgc3ltbWV0cmljIGtleSBsaWtlDQo+IHRoZSBmb3JtZXINCmJ1dCBoYXMgYSBsb25n
ZXIgbGlmZSBjeWNsZS4gSXQgaGFzIHR3byBwdXJwb3NlczoNCg0KIMKgLSBBdXRoZW50aWNhdGlv
biBvZiBuZXcgbWVtYmVyIG5vZGVzIGluIHRoZSBjbHVzdGVyLg0KIMKgIE5ldyBub2RlcywgaGF2
aW5nIG5vIGtub3dsZWRnZSBvZiBjdXJyZW50IHNlc3Npb24ga2V5cw0KIMKgIGluIHRoZSBjbHVz
dGVyIHdpbGwgc3RpbGwgYmUgYWJsZSB0byBqb2luIHRoZSBjbHVzdGVyIGFzIGxvbmcgYXMNCiDC
oCB0aGV5IGtub3cgdGhpcyBrZXkuIFRoaXMgaXMgYmVjYXVzZSBhbGwgbmVpZ2hib3IgZGlzY292
ZXJ5DQogwqAgKExJTktfQ09ORklHKSBtZXNzYWdlcyBtdXN0IGJlIGVuY3J5cHRlZCB3aXRoIHRo
aXMga2V5Lg0KDQotIEVuY3J5cHRpb24gb2Ygc2Vzc2lvbiBlbmNyeXB0aW9uIGtleXMgZHVyaW5n
IGF1dG9tYXRpYyBleGNoYW5nZQ0KIMKgIGFuZCB1cGRhdGUgb2YgdGhvc2UuIFRoaXMgaXPCoCBh
IGZlYXR1cmUgd2Ugd2lsbCBpbnRyb2R1Y2UNCiDCoCBpbiBhIGxhdGVyIGNvbW1pdCBpbiB0aGlz
IHNlcmllcy4NCldlIGluc2VydCB0aGUgbmV3IGtleSBpbnRvIHRoZSBjdXJyZW50bHkgdW51c2Vk
IHNsb3QgMCBpbiB0aGUga2V5IGFycmF5LA0KYW5kIHN0YXJ0IHVzaW5nIGl0IGltbWVkaWF0ZWx5
IG9uY2UgdGhlIHVzZXIgaGFzIHNldCBpdC4NCj4NCkFmdGVyIGpvaW5pbmcsIGEgbm9kZSBvbmx5
IGtub3dpbmcgdGhlIG1hc3RlciBrZXkgc2hvdWxkIGJlIGZ1bGx5DQo+IGNvbW11bmljYWJsZSB0
byBleGlzdGluZyBub2RlcyBpbiB0aGUgY2x1c3RlciwgYWx0aG91Z2ggdGhvc2Ugbm9kZXMgbWF5
DQo+IGhhdmUgdGhlaXIgb3duIHNlc3Npb24ga2V5cyBhY3RpdmF0ZWQgKGkuZS4gbm90IHRoZSBt
YXN0ZXIgb25lKS4gVG8NCj4gc3VwcG9ydCB0aGlzLCB3ZSBzaW1wbHkNCnMvc2ltcGx5Ly8NCj4g
ZGVmaW5lIGEgJ2dyYWNlIHBlcmlvZCcsIHN0YXJ0aW5nIGZyb20gdGhlIHRpbWUNCj4gYSBub2Rl
IGl0c2VsZiByZXBvcnRzIGhhdmluZyBubyBSWCBrZXlzLCBzbyB0aGUgZXhpc3Rpbmcgbm9kZXMg
d2lsbCB1c2UNCj4gdGhlIG1hc3RlciBrZXkgZm9yIGVuY3J5cHRpb24gaW5zdGVhZC4gVGhlIGdy
YWNlIHBlcmlvZCBjYW4gYmUgZXh0ZW5kZWQNCj4gYnV0IHdpbGwgYXV0b21hdGljYWxseSBzdG9w
IGFmdGVyLCBlLmcuIDUgc2Vjb25kcyB3aXRob3V0IGEgbmV3IHJlcG9ydC4NCj4gVGhpcyBpcyBh
bHNvIHRoZSBiYXNpcyBmb3IgbGF0ZXIga2V5IGV4Y2hhbmdpbmcgc2luY2UgdGhlIG5ldyBub2Rl
IHdpbGwNCj4gYmUgaW1wb3NzaWJsZSB0byBkZWNyeXB0IGFueXRoaW5nIHdpdGhvdXQgdGhlIHN1
cHBvcnQgZnJvbSBtYXN0ZXIga2V5Lg0KPg0KPiBGb3IgdXNlciB0byBzZXQgYSBtYXN0ZXIga2V5
LCB3ZSBkZWZpbmUgYSBuZXcgbmV0bGluayBmbGFnIC0NCj4gJ1RJUENfTkxBX05PREVfS0VZX01B
U1RFUicsIHNvIGl0IGNhbiBiZSBhZGRlZCB0byB0aGUgY3VycmVudCAnc2V0IGtleScNCj4gbmV0
bGluayBjb21tYW5kIHRvIHNwZWNpZnkgdGhlIHNldHRpbmcga2V5IHRvIGJlIGEgbWFzdGVyIGtl
eS4NCj4NCj4gQWJvdmUgYWxsLCB0aGUgdHJhZGl0aW9uYWwgY2x1c3Rlci9wZXItbm9kZSBrZXkg
bWVjaGFuaXNtIGlzIGd1YXJhbnRlZWQNCj4gdG8gd29yayB3aGVuIHVzZXIgY29tZXMgbm90IHRv
IHVzZSB0aGlzIG1hc3RlciBrZXkgb3B0aW9uLiBUaGlzIGlzIGFsc28NCj4gY29tcGF0aWJsZSB0
byBsZWdhY3kgbm9kZXMgd2l0aG91dCB0aGUgZmVhdHVyZSBzdXBwb3J0ZWQuDQpFdmVuIHRoaXMg
bmV3IGtleSBjYW4gYmUgdXBkYXRlZCB3aXRob3V0IGFueSBpbnRlcnJ1cHRpb24NCm9mIGNsdXN0
ZXIgY29ubmVjdGl2aXR5LCBidXQgaXMgc28gaXMgbmVlZGVkLCB0aGlzIGhhcyB0byBiZQ0KY29v
cmRpbmF0ZWQgYW5kIHNldCBieSB0aGUgdXNlci4NCj4NCj4gU2lnbmVkLW9mZi1ieTogVHVvbmcg
TGllbiA8dHVvbmcudC5saWVuQGRla3RlY2guY29tLmF1Pg0KPiAtLS0NCj4gICBpbmNsdWRlL3Vh
cGkvbGludXgvdGlwY19uZXRsaW5rLmggfCAgIDEgKw0KPiAgIG5ldC90aXBjL2NyeXB0by5jICAg
ICAgICAgICAgICAgICB8IDIwNiArKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0t
LQ0KPiAgIG5ldC90aXBjL2NyeXB0by5oICAgICAgICAgICAgICAgICB8ICAxNSArKy0NCj4gICBu
ZXQvdGlwYy9tc2cuaCAgICAgICAgICAgICAgICAgICAgfCAgIDQgKy0NCj4gICBuZXQvdGlwYy9u
ZXRsaW5rLmMgICAgICAgICAgICAgICAgfCAgIDEgKw0KPiAgIG5ldC90aXBjL25vZGUuYyAgICAg
ICAgICAgICAgICAgICB8ICA0NiArKysrLS0tLS0NCj4gICA2IGZpbGVzIGNoYW5nZWQsIDE4OSBp
bnNlcnRpb25zKCspLCA4NCBkZWxldGlvbnMoLSkNCj4NCj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUv
dWFwaS9saW51eC90aXBjX25ldGxpbmsuaCBiL2luY2x1ZGUvdWFwaS9saW51eC90aXBjX25ldGxp
bmsuaA0KPiBpbmRleCBkYzBkMjNhNTBlNjkuLmQ0ODRiYWE5ZDM2NSAxMDA2NDQNCj4gLS0tIGEv
aW5jbHVkZS91YXBpL2xpbnV4L3RpcGNfbmV0bGluay5oDQo+ICsrKyBiL2luY2x1ZGUvdWFwaS9s
aW51eC90aXBjX25ldGxpbmsuaA0KPiBAQCAtMTY1LDYgKzE2NSw3IEBAIGVudW0gew0KPiAgIAlU
SVBDX05MQV9OT0RFX1VQLAkJLyogZmxhZyAqLw0KPiAgIAlUSVBDX05MQV9OT0RFX0lELAkJLyog
ZGF0YSAqLw0KPiAgIAlUSVBDX05MQV9OT0RFX0tFWSwJCS8qIGRhdGEgKi8NCj4gKwlUSVBDX05M
QV9OT0RFX0tFWV9NQVNURVIsCS8qIGZsYWcgKi8NCj4gICANCj4gICAJX19USVBDX05MQV9OT0RF
X01BWCwNCj4gICAJVElQQ19OTEFfTk9ERV9NQVggPSBfX1RJUENfTkxBX05PREVfTUFYIC0gMQ0K
PiBkaWZmIC0tZ2l0IGEvbmV0L3RpcGMvY3J5cHRvLmMgYi9uZXQvdGlwYy9jcnlwdG8uYw0KPiBp
bmRleCBmMTA0NmFiNGJkMDEuLjdjNjg4Y2QwYjEzZSAxMDA2NDQNCj4gLS0tIGEvbmV0L3RpcGMv
Y3J5cHRvLmMNCj4gKysrIGIvbmV0L3RpcGMvY3J5cHRvLmMNCj4gQEAgLTM4LDYgKzM4LDcgQEAN
Cj4gICAjaW5jbHVkZSA8Y3J5cHRvL2Flcy5oPg0KPiAgICNpbmNsdWRlICJjcnlwdG8uaCINCj4g
ICANCj4gKyNkZWZpbmUgVElQQ19UWF9HUkFDRV9QRVJJT0QJbXNlY3NfdG9famlmZmllcyg1MDAw
KSAvKiA1cyAqLw0KPiAgICNkZWZpbmUgVElQQ19UWF9MQVNUSU5HX1RJTUUJbXNlY3NfdG9famlm
ZmllcygxMDAwMCkgLyogMTBzICovDQo+ICAgI2RlZmluZSBUSVBDX1JYX0FDVElWRV9MSU0JbXNl
Y3NfdG9famlmZmllcygzMDAwKSAvKiAzcyAqLw0KPiAgICNkZWZpbmUgVElQQ19SWF9QQVNTSVZF
X0xJTQltc2Vjc190b19qaWZmaWVzKDE1MDAwKSAvKiAxNXMgKi8NCj4gQEAgLTQ5LDkgKzUwLDkg
QEANCj4gICAgKiBUSVBDIEtleSBpZHMNCj4gICAgKi8NCj4gICBlbnVtIHsNCj4gLQlLRVlfVU5V
U0VEID0gMCwNCj4gLQlLRVlfTUlOLA0KPiAtCUtFWV8xID0gS0VZX01JTiwNCj4gKwlLRVlfTUFT
VEVSID0gMCwNCj4gKwlLRVlfTUlOID0gS0VZX01BU1RFUiwNCj4gKwlLRVlfMSA9IDEsDQo+ICAg
CUtFWV8yLA0KPiAgIAlLRVlfMywNCj4gICAJS0VZX01BWCA9IEtFWV8zLA0KPiBAQCAtMTY2LDI3
ICsxNjcsMzYgQEAgc3RydWN0IHRpcGNfY3J5cHRvX3N0YXRzIHsNCj4gICAgKiBAYWVhZDogYXJy
YXkgb2YgcG9pbnRlcnMgdG8gQUVBRCBrZXlzIGZvciBlbmNyeXB0aW9uL2RlY3J5cHRpb24NCj4g
ICAgKiBAcGVlcl9yeF9hY3RpdmU6IHJlcGxpY2F0ZWQgcGVlciBSWCBhY3RpdmUga2V5IGluZGV4
DQo+ICAgICogQGtleTogdGhlIGtleSBzdGF0ZXMNCj4gLSAqIEB3b3JraW5nOiB0aGUgY3J5cHRv
IGlzIHdvcmtpbmcgb3Igbm90DQo+ICAgICogQHN0YXRzOiB0aGUgY3J5cHRvIHN0YXRpc3RpY3MN
Cj4gICAgKiBAbmFtZTogdGhlIGNyeXB0byBuYW1lDQo+ICAgICogQHNuZG54dDogdGhlIHBlci1w
ZWVyIHNuZG54dCAoVFgpDQo+ICAgICogQHRpbWVyMTogZ2VuZXJhbCB0aW1lciAxIChqaWZmaWVz
KQ0KPiAgICAqIEB0aW1lcjI6IGdlbmVyYWwgdGltZXIgMiAoamlmZmllcykNCj4gKyAqIEB3b3Jr
aW5nOiB0aGUgY3J5cHRvIGlzIHdvcmtpbmcgb3Igbm90DQo+ICsgKiBAa2V5X21hc3RlcjogZmxh
ZyBpbmRpY2F0ZXMgaWYgbWFzdGVyIGtleSBleGlzdHMNCj4gKyAqIEBsZWdhY3lfdXNlcjogZmxh
ZyBpbmRpY2F0ZXMgaWYgYSBwZWVyIGpvaW5zIHcvbyBtYXN0ZXIga2V5IChmb3IgYndkIGNvbXAu
KQ0KPiAgICAqIEBsb2NrOiB0aXBjX2tleSBsb2NrDQo+ICAgICovDQo+ICAgc3RydWN0IHRpcGNf
Y3J5cHRvIHsNCj4gICAJc3RydWN0IG5ldCAqbmV0Ow0KPiAgIAlzdHJ1Y3QgdGlwY19ub2RlICpu
b2RlOw0KPiAtCXN0cnVjdCB0aXBjX2FlYWQgX19yY3UgKmFlYWRbS0VZX01BWCArIDFdOyAvKiBr
ZXlbMF0gaXMgVU5VU0VEICovDQo+ICsJc3RydWN0IHRpcGNfYWVhZCBfX3JjdSAqYWVhZFtLRVlf
TUFYICsgMV07DQo+ICAgCWF0b21pY190IHBlZXJfcnhfYWN0aXZlOw0KPiAgIAlzdHJ1Y3QgdGlw
Y19rZXkga2V5Ow0KPiAtCXU4IHdvcmtpbmc6MTsNCj4gICAJc3RydWN0IHRpcGNfY3J5cHRvX3N0
YXRzIF9fcGVyY3B1ICpzdGF0czsNCj4gICAJY2hhciBuYW1lWzQ4XTsNCj4gICANCj4gICAJYXRv
bWljNjRfdCBzbmRueHQgX19fX2NhY2hlbGluZV9hbGlnbmVkOw0KPiAgIAl1bnNpZ25lZCBsb25n
IHRpbWVyMTsNCj4gICAJdW5zaWduZWQgbG9uZyB0aW1lcjI7DQo+ICsJdW5pb24gew0KPiArCQlz
dHJ1Y3Qgew0KPiArCQkJdTggd29ya2luZzoxOw0KPiArCQkJdTgga2V5X21hc3RlcjoxOw0KPiAr
CQkJdTggbGVnYWN5X3VzZXI6MTsNCj4gKwkJfTsNCj4gKwkJdTggZmxhZ3M7DQo+ICsJfTsNCj4g
ICAJc3BpbmxvY2tfdCBsb2NrOyAvKiBjcnlwdG8gbG9jayAqLw0KPiAgIA0KPiAgIH0gX19fX2Nh
Y2hlbGluZV9hbGlnbmVkOw0KPiBAQCAtMjM2LDEzICsyNDYsMTkgQEAgc3RhdGljIGlubGluZSB2
b2lkIHRpcGNfY3J5cHRvX2tleV9zZXRfc3RhdGUoc3RydWN0IHRpcGNfY3J5cHRvICpjLA0KPiAg
IAkJCQkJICAgICB1OCBuZXdfYWN0aXZlLA0KPiAgIAkJCQkJICAgICB1OCBuZXdfcGVuZGluZyk7
DQo+ICAgc3RhdGljIGludCB0aXBjX2NyeXB0b19rZXlfYXR0YWNoKHN0cnVjdCB0aXBjX2NyeXB0
byAqYywNCj4gLQkJCQkgIHN0cnVjdCB0aXBjX2FlYWQgKmFlYWQsIHU4IHBvcyk7DQo+ICsJCQkJ
ICBzdHJ1Y3QgdGlwY19hZWFkICphZWFkLCB1OCBwb3MsDQo+ICsJCQkJICBib29sIG1hc3Rlcl9r
ZXkpOw0KPiAgIHN0YXRpYyBib29sIHRpcGNfY3J5cHRvX2tleV90cnlfYWxpZ24oc3RydWN0IHRp
cGNfY3J5cHRvICpyeCwgdTggbmV3X3BlbmRpbmcpOw0KPiAgIHN0YXRpYyBzdHJ1Y3QgdGlwY19h
ZWFkICp0aXBjX2NyeXB0b19rZXlfcGlja190eChzdHJ1Y3QgdGlwY19jcnlwdG8gKnR4LA0KPiAg
IAkJCQkJCSBzdHJ1Y3QgdGlwY19jcnlwdG8gKnJ4LA0KPiAtCQkJCQkJIHN0cnVjdCBza19idWZm
ICpza2IpOw0KPiArCQkJCQkJIHN0cnVjdCBza19idWZmICpza2IsDQo+ICsJCQkJCQkgdTggdHhf
a2V5KTsNCj4gICBzdGF0aWMgdm9pZCB0aXBjX2NyeXB0b19rZXlfc3luY2goc3RydWN0IHRpcGNf
Y3J5cHRvICpyeCwgc3RydWN0IHNrX2J1ZmYgKnNrYik7DQo+ICAgc3RhdGljIGludCB0aXBjX2Ny
eXB0b19rZXlfcmV2b2tlKHN0cnVjdCBuZXQgKm5ldCwgdTggdHhfa2V5KTsNCj4gK3N0YXRpYyBp
bmxpbmUgdm9pZCB0aXBjX2NyeXB0b19jbG9uZV9tc2coc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3Qg
c2tfYnVmZiAqX3NrYiwNCj4gKwkJCQkJIHN0cnVjdCB0aXBjX2JlYXJlciAqYiwNCj4gKwkJCQkJ
IHN0cnVjdCB0aXBjX21lZGlhX2FkZHIgKmRzdCwNCj4gKwkJCQkJIHN0cnVjdCB0aXBjX25vZGUg
Kl9fZG5vZGUsIHU4IHR5cGUpOw0KPiAgIHN0YXRpYyB2b2lkIHRpcGNfY3J5cHRvX3Jjdl9jb21w
bGV0ZShzdHJ1Y3QgbmV0ICpuZXQsIHN0cnVjdCB0aXBjX2FlYWQgKmFlYWQsDQo+ICAgCQkJCSAg
ICAgc3RydWN0IHRpcGNfYmVhcmVyICpiLA0KPiAgIAkJCQkgICAgIHN0cnVjdCBza19idWZmICoq
c2tiLCBpbnQgZXJyKTsNCj4gQEAgLTkzNyw4ICs5NTMsNiBAQCBib29sIHRpcGNfZWhkcl92YWxp
ZGF0ZShzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQ0KPiAgIAkJcmV0dXJuIGZhbHNlOw0KPiAgIAlpZiAo
dW5saWtlbHkoc2tiLT5sZW4gPD0gZWhzeiArIFRJUENfQUVTX0dDTV9UQUdfU0laRSkpDQo+ICAg
CQlyZXR1cm4gZmFsc2U7DQo+IC0JaWYgKHVubGlrZWx5KCFlaGRyLT50eF9rZXkpKQ0KPiAtCQly
ZXR1cm4gZmFsc2U7DQo+ICAgDQo+ICAgCXJldHVybiB0cnVlOw0KPiAgIH0NCj4gQEAgLTk5MSw2
ICsxMDA1LDggQEAgc3RhdGljIGludCB0aXBjX2VoZHJfYnVpbGQoc3RydWN0IG5ldCAqbmV0LCBz
dHJ1Y3QgdGlwY19hZWFkICphZWFkLA0KPiAgIAllaGRyLT50eF9rZXkgPSB0eF9rZXk7DQo+ICAg
CWVoZHItPmRlc3RpbmVkID0gKF9fcngpID8gMSA6IDA7DQo+ICAgCWVoZHItPnJ4X2tleV9hY3Rp
dmUgPSAoX19yeCkgPyBfX3J4LT5rZXkuYWN0aXZlIDogMDsNCj4gKwllaGRyLT5yeF9ub2tleSA9
IChfX3J4KSA/ICFfX3J4LT5rZXkua2V5cyA6IDA7DQo+ICsJZWhkci0+bWFzdGVyX2tleSA9IGFl
YWQtPmNyeXB0by0+a2V5X21hc3RlcjsNCj4gICAJZWhkci0+cmVzZXJ2ZWRfMSA9IDA7DQo+ICAg
CWVoZHItPnJlc2VydmVkXzIgPSAwOw0KPiAgIA0KPiBAQCAtMTAzMyw2ICsxMDQ5LDcgQEAgc3Rh
dGljIGlubGluZSB2b2lkIHRpcGNfY3J5cHRvX2tleV9zZXRfc3RhdGUoc3RydWN0IHRpcGNfY3J5
cHRvICpjLA0KPiAgICAqIEBjOiBUSVBDIGNyeXB0byB0byB3aGljaCBuZXcga2V5IGlzIGF0dGFj
aGVkDQo+ICAgICogQHVrZXk6IHRoZSB1c2VyIGtleQ0KPiAgICAqIEBtb2RlOiB0aGUga2V5IG1v
ZGUgKENMVVNURVJfS0VZIG9yIFBFUl9OT0RFX0tFWSkNCj4gKyAqIEBtYXN0ZXJfa2V5OiBzcGVj
aWZ5IHRoaXMgaXMgYSBjbHVzdGVyIG1hc3RlciBrZXkNCj4gICAgKg0KPiAgICAqIEEgbmV3IFRJ
UEMgQUVBRCBrZXkgd2lsbCBiZSBhbGxvY2F0ZWQgYW5kIGluaXRpYXRlZCB3aXRoIHRoZSBzcGVj
aWZpZWQgdXNlcg0KPiAgICAqIGtleSwgdGhlbiBhdHRhY2hlZCB0byB0aGUgVElQQyBjcnlwdG8u
DQo+IEBAIC0xMDQwLDcgKzEwNTcsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgdGlwY19jcnlwdG9f
a2V5X3NldF9zdGF0ZShzdHJ1Y3QgdGlwY19jcnlwdG8gKmMsDQo+ICAgICogUmV0dXJuOiBuZXcg
a2V5IGlkIGluIGNhc2Ugb2Ygc3VjY2Vzcywgb3RoZXJ3aXNlOiA8IDANCj4gICAgKi8NCj4gICBp
bnQgdGlwY19jcnlwdG9fa2V5X2luaXQoc3RydWN0IHRpcGNfY3J5cHRvICpjLCBzdHJ1Y3QgdGlw
Y19hZWFkX2tleSAqdWtleSwNCj4gLQkJCSB1OCBtb2RlKQ0KPiArCQkJIHU4IG1vZGUsIGJvb2wg
bWFzdGVyX2tleSkNCj4gICB7DQo+ICAgCXN0cnVjdCB0aXBjX2FlYWQgKmFlYWQgPSBOVUxMOw0K
PiAgIAlpbnQgcmMgPSAwOw0KPiBAQCAtMTA1Myw3ICsxMDcwLDcgQEAgaW50IHRpcGNfY3J5cHRv
X2tleV9pbml0KHN0cnVjdCB0aXBjX2NyeXB0byAqYywgc3RydWN0IHRpcGNfYWVhZF9rZXkgKnVr
ZXksDQo+ICAgCX0NCj4gICANCj4gICAJLyogQXR0YWNoIGl0IHRvIHRoZSBjcnlwdG8gKi8NCj4g
LQlyYyA9IHRpcGNfY3J5cHRvX2tleV9hdHRhY2goYywgYWVhZCwgMCk7DQo+ICsJcmMgPSB0aXBj
X2NyeXB0b19rZXlfYXR0YWNoKGMsIGFlYWQsIDAsIG1hc3Rlcl9rZXkpOw0KPiAgIAlpZiAocmMg
PCAwKSB7DQo+ICAgCQlwcl9lcnIoIiVzOiB1bmFibGUgdG8gYXR0YWNoIGtleSwgZXJyICVkXG4i
LCBjLT5uYW1lLCByYyk7DQo+ICAgCQl0aXBjX2FlYWRfZnJlZSgmYWVhZC0+cmN1KTsNCj4gQEAg
LTEwNjksMTEgKzEwODYsMTMgQEAgaW50IHRpcGNfY3J5cHRvX2tleV9pbml0KHN0cnVjdCB0aXBj
X2NyeXB0byAqYywgc3RydWN0IHRpcGNfYWVhZF9rZXkgKnVrZXksDQo+ICAgICogQGM6IFRJUEMg
Y3J5cHRvIHRvIHdoaWNoIHRoZSBuZXcgQUVBRCBrZXkgaXMgYXR0YWNoZWQNCj4gICAgKiBAYWVh
ZDogdGhlIG5ldyBBRUFEIGtleSBwb2ludGVyDQo+ICAgICogQHBvczogZGVzaXJlZCBzbG90IGlu
IHRoZSBjcnlwdG8ga2V5IGFycmF5LCA9IDAgaWYgYW55IQ0KPiArICogQG1hc3Rlcl9rZXk6IHNw
ZWNpZnkgdGhpcyBpcyBhIGNsdXN0ZXIgbWFzdGVyIGtleQ0KPiAgICAqDQo+ICAgICogUmV0dXJu
OiBuZXcga2V5IGlkIGluIGNhc2Ugb2Ygc3VjY2Vzcywgb3RoZXJ3aXNlOiAtRUJVU1kNCj4gICAg
Ki8NCj4gICBzdGF0aWMgaW50IHRpcGNfY3J5cHRvX2tleV9hdHRhY2goc3RydWN0IHRpcGNfY3J5
cHRvICpjLA0KPiAtCQkJCSAgc3RydWN0IHRpcGNfYWVhZCAqYWVhZCwgdTggcG9zKQ0KPiArCQkJ
CSAgc3RydWN0IHRpcGNfYWVhZCAqYWVhZCwgdTggcG9zLA0KPiArCQkJCSAgYm9vbCBtYXN0ZXJf
a2V5KQ0KPiAgIHsNCj4gICAJc3RydWN0IHRpcGNfa2V5IGtleTsNCj4gICAJaW50IHJjID0gLUVC
VVNZOw0KPiBAQCAtMTA4MSw2ICsxMTAwLDEwIEBAIHN0YXRpYyBpbnQgdGlwY19jcnlwdG9fa2V5
X2F0dGFjaChzdHJ1Y3QgdGlwY19jcnlwdG8gKmMsDQo+ICAgDQo+ICAgCXNwaW5fbG9ja19iaCgm
Yy0+bG9jayk7DQo+ICAgCWtleSA9IGMtPmtleTsNCj4gKwlpZiAobWFzdGVyX2tleSkgew0KPiAr
CQluZXdfa2V5ID0gS0VZX01BU1RFUjsNCj4gKwkJZ290byBhdHRhY2g7DQo+ICsJfQ0KPiAgIAlp
ZiAoa2V5LmFjdGl2ZSAmJiBrZXkucGFzc2l2ZSkNCj4gICAJCWdvdG8gZXhpdDsNCj4gICAJaWYg
KGtleS5wZW5kaW5nKSB7DQo+IEBAIC0xMTEyLDggKzExMzUsNyBAQCBzdGF0aWMgaW50IHRpcGNf
Y3J5cHRvX2tleV9hdHRhY2goc3RydWN0IHRpcGNfY3J5cHRvICpjLA0KPiAgIAkJdGlwY19jcnlw
dG9fa2V5X3NldF9zdGF0ZShjLCBrZXkucGFzc2l2ZSwga2V5LmFjdGl2ZSwNCj4gICAJCQkJCSAg
a2V5LnBlbmRpbmcpOw0KPiAgIAljLT53b3JraW5nID0gMTsNCj4gLQljLT50aW1lcjEgPSBqaWZm
aWVzOw0KPiAtCWMtPnRpbWVyMiA9IGppZmZpZXM7DQo+ICsJYy0+a2V5X21hc3RlciB8PSBtYXN0
ZXJfa2V5Ow0KPiAgIAlyYyA9IG5ld19rZXk7DQo+ICAgDQo+ICAgZXhpdDoNCj4gQEAgLTExMjYs
NyArMTE0OCw3IEBAIHZvaWQgdGlwY19jcnlwdG9fa2V5X2ZsdXNoKHN0cnVjdCB0aXBjX2NyeXB0
byAqYykNCj4gICAJaW50IGs7DQo+ICAgDQo+ICAgCXNwaW5fbG9ja19iaCgmYy0+bG9jayk7DQo+
IC0JYy0+d29ya2luZyA9IDA7DQo+ICsJYy0+ZmxhZ3MgPSAwOw0KPiAgIAl0aXBjX2NyeXB0b19r
ZXlfc2V0X3N0YXRlKGMsIDAsIDAsIDApOw0KPiAgIAlmb3IgKGsgPSBLRVlfTUlOOyBrIDw9IEtF
WV9NQVg7IGsrKykNCj4gICAJCXRpcGNfY3J5cHRvX2tleV9kZXRhY2goYy0+YWVhZFtrXSwgJmMt
PmxvY2spOw0KPiBAQCAtMTIwMiw2ICsxMjI0LDcgQEAgc3RhdGljIGJvb2wgdGlwY19jcnlwdG9f
a2V5X3RyeV9hbGlnbihzdHJ1Y3QgdGlwY19jcnlwdG8gKnJ4LCB1OCBuZXdfcGVuZGluZykNCj4g
ICAgKiBAdHg6IFRYIGNyeXB0byBoYW5kbGUNCj4gICAgKiBAcng6IFJYIGNyeXB0byBoYW5kbGUg
KGNhbiBiZSBOVUxMKQ0KPiAgICAqIEBza2I6IHRoZSBtZXNzYWdlIHNrYiB3aGljaCB3aWxsIGJl
IGRlY3J5cHRlZCBsYXRlcg0KPiArICogQHR4X2tleTogcGVlciBUWCBrZXkgaWQNCj4gICAgKg0K
PiAgICAqIFRoaXMgZnVuY3Rpb24gbG9va3MgdXAgdGhlIGV4aXN0aW5nIFRYIGtleXMgYW5kIHBp
Y2sgb25lIHdoaWNoIGlzIHN1aXRhYmxlDQo+ICAgICogZm9yIHRoZSBtZXNzYWdlIGRlY3J5cHRp
b24sIHRoYXQgbXVzdCBiZSBhIGNsdXN0ZXIga2V5IGFuZCBub3QgdXNlZCBiZWZvcmUNCj4gQEAg
LTEyMTEsNyArMTIzNCw4IEBAIHN0YXRpYyBib29sIHRpcGNfY3J5cHRvX2tleV90cnlfYWxpZ24o
c3RydWN0IHRpcGNfY3J5cHRvICpyeCwgdTggbmV3X3BlbmRpbmcpDQo+ICAgICovDQo+ICAgc3Rh
dGljIHN0cnVjdCB0aXBjX2FlYWQgKnRpcGNfY3J5cHRvX2tleV9waWNrX3R4KHN0cnVjdCB0aXBj
X2NyeXB0byAqdHgsDQo+ICAgCQkJCQkJIHN0cnVjdCB0aXBjX2NyeXB0byAqcngsDQo+IC0JCQkJ
CQkgc3RydWN0IHNrX2J1ZmYgKnNrYikNCj4gKwkJCQkJCSBzdHJ1Y3Qgc2tfYnVmZiAqc2tiLA0K
PiArCQkJCQkJIHU4IHR4X2tleSkNCj4gICB7DQo+ICAgCXN0cnVjdCB0aXBjX3NrYl9jYiAqc2ti
X2NiID0gVElQQ19TS0JfQ0Ioc2tiKTsNCj4gICAJc3RydWN0IHRpcGNfYWVhZCAqYWVhZCA9IE5V
TEw7DQo+IEBAIC0xMjMwLDYgKzEyNTQsMTAgQEAgc3RhdGljIHN0cnVjdCB0aXBjX2FlYWQgKnRp
cGNfY3J5cHRvX2tleV9waWNrX3R4KHN0cnVjdCB0aXBjX2NyeXB0byAqdHgsDQo+ICAgDQo+ICAg
CS8qIFBpY2sgb25lIFRYIGtleSAqLw0KPiAgIAlzcGluX2xvY2soJnR4LT5sb2NrKTsNCj4gKwlp
ZiAodHhfa2V5ID09IEtFWV9NQVNURVIpIHsNCj4gKwkJYWVhZCA9IHRpcGNfYWVhZF9yY3VfcHRy
KHR4LT5hZWFkW0tFWV9NQVNURVJdLCAmdHgtPmxvY2spOw0KPiArCQlnb3RvIGRvbmU7DQo+ICsJ
fQ0KPiAgIAlkbyB7DQo+ICAgCQlrID0gKGkgPT0gMCkgPyBrZXkucGVuZGluZyA6DQo+ICAgCQkJ
KChpID09IDEpID8ga2V5LmFjdGl2ZSA6IGtleS5wYXNzaXZlKTsNCj4gQEAgLTEyNDksOSArMTI3
NywxMiBAQCBzdGF0aWMgc3RydWN0IHRpcGNfYWVhZCAqdGlwY19jcnlwdG9fa2V5X3BpY2tfdHgo
c3RydWN0IHRpcGNfY3J5cHRvICp0eCwNCj4gICAJCXNrYi0+bmV4dCA9IHNrYl9jbG9uZShza2Is
IEdGUF9BVE9NSUMpOw0KPiAgIAkJaWYgKHVubGlrZWx5KCFza2ItPm5leHQpKQ0KPiAgIAkJCXBy
X3dhcm4oIkZhaWxlZCB0byBjbG9uZSBza2IgZm9yIG5leHQgcm91bmQgaWYgYW55XG4iKTsNCj4g
LQkJV0FSTl9PTighcmVmY291bnRfaW5jX25vdF96ZXJvKCZhZWFkLT5yZWZjbnQpKTsNCj4gICAJ
CWJyZWFrOw0KPiAgIAl9IHdoaWxlICgrK2kgPCAzKTsNCj4gKw0KPiArZG9uZToNCj4gKwlpZiAo
bGlrZWx5KGFlYWQpKQ0KPiArCQlXQVJOX09OKCFyZWZjb3VudF9pbmNfbm90X3plcm8oJmFlYWQt
PnJlZmNudCkpOw0KPiAgIAlzcGluX3VubG9jaygmdHgtPmxvY2spOw0KPiAgIA0KPiAgIAlyZXR1
cm4gYWVhZDsNCj4gQEAgLTEyNjYsNiArMTI5Nyw5IEBAIHN0YXRpYyBzdHJ1Y3QgdGlwY19hZWFk
ICp0aXBjX2NyeXB0b19rZXlfcGlja190eChzdHJ1Y3QgdGlwY19jcnlwdG8gKnR4LA0KPiAgICAq
IGhhcyBjaGFuZ2VkLCBzbyB0aGUgbnVtYmVyIG9mIFRYIGtleXMnIHVzZXJzIG9uIHRoaXMgbm9k
ZSBhcmUgaW5jcmVhc2VkIGFuZA0KPiAgICAqIGRlY3JlYXNlZCBjb3JyZXNwb25kaW5nbHkuDQo+
ICAgICoNCj4gKyAqIEl0IGFsc28gY29uc2lkZXJzIGlmIHBlZXIgaGFzIG5vIGtleSwgdGhlbiB3
ZSBuZWVkIHRvIG1ha2Ugb3duIG1hc3RlciBrZXkNCj4gKyAqIChpZiBhbnkpIHRha2luZyBvdmVy
IGkuZS4gc3RhcnRpbmcgZ3JhY2UgcGVyaW9kLg0KPiArICoNCj4gICAgKiBUaGUgInBlci1wZWVy
IiBzbmRueHQgaXMgYWxzbyByZXNldCB3aGVuIHRoZSBwZWVyIGtleSBoYXMgc3dpdGNoZWQuDQo+
ICAgICovDQo+ICAgc3RhdGljIHZvaWQgdGlwY19jcnlwdG9fa2V5X3N5bmNoKHN0cnVjdCB0aXBj
X2NyeXB0byAqcngsIHN0cnVjdCBza19idWZmICpza2IpDQo+IEBAIC0xMjc2LDExICsxMzEwLDIz
IEBAIHN0YXRpYyB2b2lkIHRpcGNfY3J5cHRvX2tleV9zeW5jaChzdHJ1Y3QgdGlwY19jcnlwdG8g
KnJ4LCBzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQ0KPiAgIAl1MzIgc2VsZiA9IHRpcGNfb3duX2FkZHIo
cngtPm5ldCk7DQo+ICAgCXU4IGN1ciwgbmV3Ow0KPiAgIA0KPiAtCS8qIEVuc3VyZSB0aGlzIG1l
c3NhZ2UgaXMgZGVzdGluZWQgdG8gdXMgZmlyc3QgKi8NCj4gKwkvKiBVcGRhdGUgUlggJ2tleV9t
YXN0ZXInIGZsYWcgYWNjb3JkaW5nIHRvIHBlZXIsIGFsc28gbWFyayAibGVnYWN5IiBpZg0KPiAr
CSAqIGEgcGVlciBoYXMgbm8gbWFzdGVyIGtleS4NCj4gKwkgKi8NCj4gKwlyeC0+a2V5X21hc3Rl
ciA9IGVoZHItPm1hc3Rlcl9rZXk7DQo+ICsJaWYgKCFyeC0+a2V5X21hc3RlcikNCj4gKwkJdHgt
PmxlZ2FjeV91c2VyID0gMTsNCj4gKw0KPiArCS8qIEZvciBsYXRlciBjYXNlcywgYXBwbHkgb25s
eSBpZiBtZXNzYWdlIGlzIGRlc3RpbmVkIHRvIHRoaXMgbm9kZSAqLw0KPiAgIAlpZiAoIWVoZHIt
PmRlc3RpbmVkIHx8IG1zZ19zaG9ydChoZHIpIHx8IG1zZ19kZXN0bm9kZShoZHIpICE9IHNlbGYp
DQo+ICAgCQlyZXR1cm47DQo+ICAgDQo+IC0JLyogUGVlciBSWCBhY3RpdmUga2V5IGhhcyBjaGFu
Z2VkLCBsZXQncyB1cGRhdGUgb3duIFRYIHVzZXJzICovDQo+ICsJLyogQ2FzZSAxOiBQZWVyIGhh
cyBubyBrZXlzLCBsZXQncyBtYWtlIG1hc3RlciBrZXkgdGFraW5nIG92ZXIgKi8NCnMvdGFraW5n
L3Rha2UvDQo+ICsJaWYgKGVoZHItPnJ4X25va2V5KQ0KPiArCQkvKiBTZXQgb3IgZXh0ZW5kIGdy
YWNlIHBlcmlvZCAqLw0KPiArCQl0eC0+dGltZXIyID0gamlmZmllczsNCj4gKw0KPiArCS8qIENh
c2UgMjogUGVlciBSWCBhY3RpdmUga2V5IGhhcyBjaGFuZ2VkLCBsZXQncyB1cGRhdGUgb3duIFRY
IHVzZXJzICovDQo+ICAgCWN1ciA9IGF0b21pY19yZWFkKCZyeC0+cGVlcl9yeF9hY3RpdmUpOw0K
PiAgIAluZXcgPSBlaGRyLT5yeF9rZXlfYWN0aXZlOw0KPiAgIAlpZiAodHgtPmtleS5rZXlzICYm
DQo+IEBAIC0xMzM4LDcgKzEzODQsNyBAQCBpbnQgdGlwY19jcnlwdG9fc3RhcnQoc3RydWN0IHRp
cGNfY3J5cHRvICoqY3J5cHRvLCBzdHJ1Y3QgbmV0ICpuZXQsDQo+ICAgCQlyZXR1cm4gLUVOT01F
TTsNCj4gICAJfQ0KPiAgIA0KPiAtCWMtPndvcmtpbmcgPSAwOw0KPiArCWMtPmZsYWdzID0gMDsN
Cj4gICAJYy0+bmV0ID0gbmV0Ow0KPiAgIAljLT5ub2RlID0gbm9kZTsNCj4gICAJdGlwY19jcnlw
dG9fa2V5X3NldF9zdGF0ZShjLCAwLCAwLCAwKTsNCj4gQEAgLTE0NzMsNiArMTUxOSwxMiBAQCB2
b2lkIHRpcGNfY3J5cHRvX3RpbWVvdXQoc3RydWN0IHRpcGNfY3J5cHRvICpyeCkNCj4gICBzNToN
Cj4gICAJc3Bpbl91bmxvY2soJnJ4LT5sb2NrKTsNCj4gICANCj4gKwkvKiBSZWxheCBpdCBoZXJl
LCB0aGUgZmxhZyB3aWxsIGJlIHNldCBhZ2FpbiBpZiBpdCByZWFsbHkgaXMsIGJ1dCBvbmx5DQo+
ICsJICogd2hlbiB3ZSBhcmUgbm90IGluIGdyYWNlIHBlcmlvZCBmb3Igc2FmZXR5IQ0KPiArCSAq
Lw0KPiArCWlmICh0aW1lX2FmdGVyKGppZmZpZXMsIHR4LT50aW1lcjIgKyBUSVBDX1RYX0dSQUNF
X1BFUklPRCkpDQo+ICsJCXR4LT5sZWdhY3lfdXNlciA9IDA7DQo+ICsNCj4gICAJLyogTGltaXQg
bWF4X3RmbXMgJiBkbyBkZWJ1ZyBjb21tYW5kcyBpZiBuZWVkZWQgKi8NCj4gICAJaWYgKGxpa2Vs
eShzeXNjdGxfdGlwY19tYXhfdGZtcyA8PSBUSVBDX01BWF9URk1TX0xJTSkpDQo+ICAgCQlyZXR1
cm47DQo+IEBAIC0xNDgyLDYgKzE1MzQsMjIgQEAgdm9pZCB0aXBjX2NyeXB0b190aW1lb3V0KHN0
cnVjdCB0aXBjX2NyeXB0byAqcngpDQo+ICAgCXRpcGNfY3J5cHRvX2RvX2NtZChyeC0+bmV0LCBj
bWQpOw0KPiAgIH0NCj4gICANCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCB0aXBjX2NyeXB0b19jbG9u
ZV9tc2coc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3Qgc2tfYnVmZiAqX3NrYiwNCj4gKwkJCQkJIHN0
cnVjdCB0aXBjX2JlYXJlciAqYiwNCj4gKwkJCQkJIHN0cnVjdCB0aXBjX21lZGlhX2FkZHIgKmRz
dCwNCj4gKwkJCQkJIHN0cnVjdCB0aXBjX25vZGUgKl9fZG5vZGUsIHU4IHR5cGUpDQo+ICt7DQo+
ICsJc3RydWN0IHNrX2J1ZmYgKnNrYjsNCj4gKw0KPiArCXNrYiA9IHNrYl9jbG9uZShfc2tiLCBH
RlBfQVRPTUlDKTsNCj4gKwlpZiAoc2tiKSB7DQo+ICsJCVRJUENfU0tCX0NCKHNrYiktPnhtaXRf
dHlwZSA9IHR5cGU7DQo+ICsJCXRpcGNfY3J5cHRvX3htaXQobmV0LCAmc2tiLCBiLCBkc3QsIF9f
ZG5vZGUpOw0KPiArCQlpZiAoc2tiKQ0KPiArCQkJYi0+bWVkaWEtPnNlbmRfbXNnKG5ldCwgc2ti
LCBiLCBkc3QpOw0KPiArCX0NCj4gK30NCj4gKw0KPiAgIC8qKg0KPiAgICAqIHRpcGNfY3J5cHRv
X3htaXQgLSBCdWlsZCAmIGVuY3J5cHQgVElQQyBtZXNzYWdlIGZvciB4bWl0DQo+ICAgICogQG5l
dDogc3RydWN0IG5ldA0KPiBAQCAtMTQ5MSw3ICsxNTU5LDggQEAgdm9pZCB0aXBjX2NyeXB0b190
aW1lb3V0KHN0cnVjdCB0aXBjX2NyeXB0byAqcngpDQo+ICAgICogQF9fZG5vZGU6IGRlc3RpbmF0
aW9uIG5vZGUgZm9yIHJlZmVyZW5jZSBpZiBhbnkNCj4gICAgKg0KPiAgICAqIEZpcnN0LCBidWls
ZCBhbiBlbmNyeXB0aW9uIG1lc3NhZ2UgaGVhZGVyIG9uIHRoZSB0b3Agb2YgdGhlIG1lc3NhZ2Us
IHRoZW4NCj4gLSAqIGVuY3J5cHQgdGhlIG9yaWdpbmFsIFRJUEMgbWVzc2FnZSBieSB1c2luZyB0
aGUgYWN0aXZlIG9yIHBlbmRpbmcgVFgga2V5Lg0KPiArICogZW5jcnlwdCB0aGUgb3JpZ2luYWwg
VElQQyBtZXNzYWdlIGJ5IHVzaW5nIHRoZSBwZW5kaW5nLCBtYXN0ZXIgb3IgYWN0aXZlDQo+ICsg
KiBrZXkgd2l0aCB0aGlzIHByZWZlcmVuY2Ugb3JkZXIuDQo+ICAgICogSWYgdGhlIGVuY3J5cHRp
b24gaXMgc3VjY2Vzc2Z1bCwgdGhlIGVuY3J5cHRlZCBza2IgaXMgcmV0dXJuZWQgZGlyZWN0bHkg
b3INCj4gICAgKiB2aWEgdGhlIGNhbGxiYWNrLg0KPiAgICAqIE90aGVyd2lzZSwgdGhlIHNrYiBp
cyBmcmVlZCENCj4gQEAgLTE1MTQsNDYgKzE1ODMsNjMgQEAgaW50IHRpcGNfY3J5cHRvX3htaXQo
c3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3Qgc2tfYnVmZiAqKnNrYiwNCj4gICAJc3RydWN0IHRpcGNf
bXNnICpoZHIgPSBidWZfbXNnKCpza2IpOw0KPiAgIAlzdHJ1Y3QgdGlwY19rZXkga2V5ID0gdHgt
PmtleTsNCj4gICAJc3RydWN0IHRpcGNfYWVhZCAqYWVhZCA9IE5VTEw7DQo+IC0Jc3RydWN0IHNr
X2J1ZmYgKl9za2I7DQo+IC0JaW50IHJjID0gLUVOT0tFWTsNCj4gICAJdTMyIHVzZXIgPSBtc2df
dXNlcihoZHIpOw0KPiAtCXU4IHR4X2tleTsNCj4gKwl1MzIgdHlwZSA9IG1zZ190eXBlKGhkcik7
DQo+ICsJaW50IHJjID0gLUVOT0tFWTsNCj4gKwl1OCB0eF9rZXkgPSAwOw0KPiAgIA0KPiAgIAkv
KiBObyBlbmNyeXB0aW9uPyAqLw0KPiAgIAlpZiAoIXR4LT53b3JraW5nKQ0KPiAgIAkJcmV0dXJu
IDA7DQo+ICAgDQo+IC0JLyogVHJ5IHdpdGggdGhlIHBlbmRpbmcga2V5IGlmIGF2YWlsYWJsZSBh
bmQ6DQo+IC0JICogMSkgVGhpcyBpcyB0aGUgb25seSBjaG9pY2UgKGkuZS4gbm8gYWN0aXZlIGtl
eSkgb3I7DQo+IC0JICogMikgUGVlciBoYXMgc3dpdGNoZWQgdG8gdGhpcyBrZXkgKHVuaWNhc3Qg
b25seSkgb3I7DQo+IC0JICogMykgSXQgaXMgdGltZSB0byBkbyBhIHBlbmRpbmcga2V5IHByb2Jl
Ow0KPiAtCSAqLw0KPiArCS8qIFBlbmRpbmcga2V5IGlmIHBlZXIgaGFzIGFjdGl2ZSBvbiBpdCBv
ciBwcm9iaW5nIHRpbWUgKi8NCj4gICAJaWYgKHVubGlrZWx5KGtleS5wZW5kaW5nKSkgew0KPiAg
IAkJdHhfa2V5ID0ga2V5LnBlbmRpbmc7DQo+IC0JCWlmICgha2V5LmFjdGl2ZSkNCj4gKwkJaWYg
KCF0eC0+a2V5X21hc3RlciAmJiAha2V5LmFjdGl2ZSkNCj4gICAJCQlnb3RvIGVuY3J5cHQ7DQo+
ICAgCQlpZiAoX19yeCAmJiBhdG9taWNfcmVhZCgmX19yeC0+cGVlcl9yeF9hY3RpdmUpID09IHR4
X2tleSkNCj4gICAJCQlnb3RvIGVuY3J5cHQ7DQo+IC0JCWlmIChUSVBDX1NLQl9DQigqc2tiKS0+
cHJvYmUpIHsNCj4gKwkJaWYgKFRJUENfU0tCX0NCKCpza2IpLT54bWl0X3R5cGUgPT0gU0tCX1BS
T0JJTkcpIHsNCj4gICAJCQlwcl9kZWJ1ZygiJXM6IHByb2JpbmcgZm9yIGtleVslZF1cbiIsIHR4
LT5uYW1lLA0KPiAgIAkJCQkga2V5LnBlbmRpbmcpOw0KPiAgIAkJCWdvdG8gZW5jcnlwdDsNCj4g
ICAJCX0NCj4gLQkJaWYgKHVzZXIgPT0gTElOS19DT05GSUcgfHwgdXNlciA9PSBMSU5LX1BST1RP
Q09MKSB7DQo+IC0JCQlfc2tiID0gc2tiX2Nsb25lKCpza2IsIEdGUF9BVE9NSUMpOw0KPiAtCQkJ
aWYgKF9za2IpIHsNCj4gLQkJCQlUSVBDX1NLQl9DQihfc2tiKS0+cHJvYmUgPSAxOw0KPiAtCQkJ
CXRpcGNfY3J5cHRvX3htaXQobmV0LCAmX3NrYiwgYiwgZHN0LCBfX2Rub2RlKTsNCj4gLQkJCQlp
ZiAoX3NrYikNCj4gLQkJCQkJYi0+bWVkaWEtPnNlbmRfbXNnKG5ldCwgX3NrYiwgYiwgZHN0KTsN
Cj4gKwkJaWYgKHVzZXIgPT0gTElOS19DT05GSUcgfHwgdXNlciA9PSBMSU5LX1BST1RPQ09MKQ0K
PiArCQkJdGlwY19jcnlwdG9fY2xvbmVfbXNnKG5ldCwgKnNrYiwgYiwgZHN0LCBfX2Rub2RlLA0K
PiArCQkJCQkgICAgICBTS0JfUFJPQklORyk7DQo+ICsJfQ0KPiArDQo+ICsJLyogTWFzdGVyIGtl
eSBpZiB0aGlzIGlzIGEgKnZpdGFsKiBtZXNzYWdlIG9yIGluIGdyYWNlIHBlcmlvZCAqLw0KPiAr
CWlmICh0eC0+a2V5X21hc3Rlcikgew0KPiArCQl0eF9rZXkgPSBLRVlfTUFTVEVSOw0KPiArCQlp
ZiAoIWtleS5hY3RpdmUpDQo+ICsJCQlnb3RvIGVuY3J5cHQ7DQo+ICsJCWlmIChUSVBDX1NLQl9D
Qigqc2tiKS0+eG1pdF90eXBlID09IFNLQl9HUkFDSU5HKSB7DQo+ICsJCQlwcl9kZWJ1ZygiJXM6
IGdyYWNpbmcgZm9yIG1zZyAoJWQgJWQpXG4iLCB0eC0+bmFtZSwNCj4gKwkJCQkgdXNlciwgdHlw
ZSk7DQo+ICsJCQlnb3RvIGVuY3J5cHQ7DQo+ICsJCX0NCj4gKwkJaWYgKHVzZXIgPT0gTElOS19D
T05GSUcgfHwNCj4gKwkJICAgICh1c2VyID09IExJTktfUFJPVE9DT0wgJiYgdHlwZSA9PSBSRVNF
VF9NU0cpIHx8DQo+ICsJCSAgICB0aW1lX2JlZm9yZShqaWZmaWVzLCB0eC0+dGltZXIyICsgVElQ
Q19UWF9HUkFDRV9QRVJJT0QpKSB7DQpXaHkgZG8gUkVTRVQgbWVzc2FnZXMgbmVlZCB0byBiZSBl
bmNyeXB0ZWQgd2l0aCB0aGUgbWFzdGVyIGtleT8NCj4gKwkJCWlmIChfX3J4ICYmIF9fcngtPmtl
eV9tYXN0ZXIgJiYNCj4gKwkJCSAgICAhYXRvbWljX3JlYWQoJl9fcngtPnBlZXJfcnhfYWN0aXZl
KSkNCj4gKwkJCQlnb3RvIGVuY3J5cHQ7DQo+ICsJCQlpZiAoIV9fcngpIHsNCj4gKwkJCQlpZiAo
bGlrZWx5KCF0eC0+bGVnYWN5X3VzZXIpKQ0KPiArCQkJCQlnb3RvIGVuY3J5cHQ7DQo+ICsJCQkJ
dGlwY19jcnlwdG9fY2xvbmVfbXNnKG5ldCwgKnNrYiwgYiwgZHN0LA0KPiArCQkJCQkJICAgICAg
X19kbm9kZSwgU0tCX0dSQUNJTkcpOw0KPiAgIAkJCX0NCj4gICAJCX0NCj4gICAJfQ0KPiArDQo+
ICAgCS8qIEVsc2UsIHVzZSB0aGUgYWN0aXZlIGtleSBpZiBhbnkgKi8NCj4gICAJaWYgKGxpa2Vs
eShrZXkuYWN0aXZlKSkgew0KPiAgIAkJdHhfa2V5ID0ga2V5LmFjdGl2ZTsNCj4gICAJCWdvdG8g
ZW5jcnlwdDsNCj4gICAJfQ0KPiArDQo+ICAgCWdvdG8gZXhpdDsNCj4gICANCj4gICBlbmNyeXB0
Og0KPiBAQCAtMTYxOSwxNSArMTcwNSwxNiBAQCBpbnQgdGlwY19jcnlwdG9fcmN2KHN0cnVjdCBu
ZXQgKm5ldCwgc3RydWN0IHRpcGNfY3J5cHRvICpyeCwNCj4gICAJc3RydWN0IHRpcGNfYWVhZCAq
YWVhZCA9IE5VTEw7DQo+ICAgCXN0cnVjdCB0aXBjX2tleSBrZXk7DQo+ICAgCWludCByYyA9IC1F
Tk9LRVk7DQo+IC0JdTggdHhfa2V5ID0gMDsNCj4gKwl1OCB0eF9rZXk7DQo+ICsNCj4gKwl0eF9r
ZXkgPSAoKHN0cnVjdCB0aXBjX2VoZHIgKikoKnNrYiktPmRhdGEpLT50eF9rZXk7DQo+ICAgDQo+
ICAgCS8qIE5ldyBwZWVyPw0KPiAgIAkgKiBMZXQncyB0cnkgd2l0aCBUWCBrZXkgKGkuZS4gY2x1
c3RlciBtb2RlKSAmIHZlcmlmeSB0aGUgc2tiIGZpcnN0IQ0KPiAgIAkgKi8NCj4gLQlpZiAodW5s
aWtlbHkoIXJ4KSkNCj4gKwlpZiAodW5saWtlbHkoIXJ4IHx8IHR4X2tleSA9PSBLRVlfTUFTVEVS
KSkNCj4gICAJCWdvdG8gcGlja190eDsNCj4gICANCj4gLQl0eF9rZXkgPSAoKHN0cnVjdCB0aXBj
X2VoZHIgKikoKnNrYiktPmRhdGEpLT50eF9rZXk7DQo+ICAgCS8qIFBpY2sgUlgga2V5IGFjY29y
ZGluZyB0byBUWCBrZXkgaWYgYW55ICovDQo+ICAgCWtleSA9IHJ4LT5rZXk7DQo+ICAgCWlmICh0
eF9rZXkgPT0ga2V5LmFjdGl2ZSB8fCB0eF9rZXkgPT0ga2V5LnBlbmRpbmcgfHwNCj4gQEAgLTE2
NDAsNyArMTcyNyw3IEBAIGludCB0aXBjX2NyeXB0b19yY3Yoc3RydWN0IG5ldCAqbmV0LCBzdHJ1
Y3QgdGlwY19jcnlwdG8gKnJ4LA0KPiAgIA0KPiAgIHBpY2tfdHg6DQo+ICAgCS8qIE5vIGtleSBz
dWl0YWJsZT8gVHJ5IHRvIHBpY2sgb25lIGZyb20gVFguLi4gKi8NCj4gLQlhZWFkID0gdGlwY19j
cnlwdG9fa2V5X3BpY2tfdHgodHgsIHJ4LCAqc2tiKTsNCj4gKwlhZWFkID0gdGlwY19jcnlwdG9f
a2V5X3BpY2tfdHgodHgsIHJ4LCAqc2tiLCB0eF9rZXkpOw0KPiAgIAlpZiAoYWVhZCkNCj4gICAJ
CWdvdG8gZGVjcnlwdDsNCj4gICAJZ290byBleGl0Ow0KPiBAQCAtMTcyMiw5ICsxODA5LDEyIEBA
IHN0YXRpYyB2b2lkIHRpcGNfY3J5cHRvX3Jjdl9jb21wbGV0ZShzdHJ1Y3QgbmV0ICpuZXQsIHN0
cnVjdCB0aXBjX2FlYWQgKmFlYWQsDQo+ICAgCQkJCWdvdG8gZnJlZV9za2I7DQo+ICAgCQl9DQo+
ICAgDQo+ICsJCS8qIElnbm9yZSBjbG9uaW5nIGlmIGl0IHdhcyBUWCBtYXN0ZXIga2V5ICovDQo+
ICsJCWlmIChlaGRyLT50eF9rZXkgPT0gS0VZX01BU1RFUikNCj4gKwkJCWdvdG8gcmN2Ow0KPiAg
IAkJaWYgKHRpcGNfYWVhZF9jbG9uZSgmdG1wLCBhZWFkKSA8IDApDQo+ICAgCQkJZ290byByY3Y7
DQo+IC0JCWlmICh0aXBjX2NyeXB0b19rZXlfYXR0YWNoKHJ4LCB0bXAsIGVoZHItPnR4X2tleSkg
PCAwKSB7DQo+ICsJCWlmICh0aXBjX2NyeXB0b19rZXlfYXR0YWNoKHJ4LCB0bXAsIGVoZHItPnR4
X2tleSwgZmFsc2UpIDwgMCkgew0KPiAgIAkJCXRpcGNfYWVhZF9mcmVlKCZ0bXAtPnJjdSk7DQo+
ICAgCQkJZ290byByY3Y7DQo+ICAgCQl9DQo+IEBAIC0xNzQwLDEwICsxODMwLDEwIEBAIHN0YXRp
YyB2b2lkIHRpcGNfY3J5cHRvX3Jjdl9jb21wbGV0ZShzdHJ1Y3QgbmV0ICpuZXQsIHN0cnVjdCB0
aXBjX2FlYWQgKmFlYWQsDQo+ICAgCS8qIFNldCB0aGUgUlgga2V5J3MgdXNlciAqLw0KPiAgIAl0
aXBjX2FlYWRfdXNlcnNfc2V0KGFlYWQsIDEpOw0KPiAgIA0KPiAtcmN2Og0KPiAgIAkvKiBNYXJr
IHRoaXMgcG9pbnQsIFJYIHdvcmtzICovDQo+ICAgCXJ4LT50aW1lcjEgPSBqaWZmaWVzOw0KPiAg
IA0KPiArcmN2Og0KPiAgIAkvKiBSZW1vdmUgZWhkciAmIGF1dGguIHRhZyBwcmlvciB0byB0aXBj
X3JjdigpICovDQo+ICAgCWVoZHIgPSAoc3RydWN0IHRpcGNfZWhkciAqKSgqc2tiKS0+ZGF0YTsN
Cj4gICANCj4gQEAgLTE4NjUsMTQgKzE5NTUsMjQgQEAgc3RhdGljIGNoYXIgKnRpcGNfY3J5cHRv
X2tleV9kdW1wKHN0cnVjdCB0aXBjX2NyeXB0byAqYywgY2hhciAqYnVmKQ0KPiAgIAljaGFyICpz
Ow0KPiAgIA0KPiAgIAlmb3IgKGsgPSBLRVlfTUlOOyBrIDw9IEtFWV9NQVg7IGsrKykgew0KPiAt
CQlpZiAoayA9PSBrZXkucGFzc2l2ZSkNCj4gLQkJCXMgPSAiUEFTIjsNCj4gLQkJZWxzZSBpZiAo
ayA9PSBrZXkuYWN0aXZlKQ0KPiAtCQkJcyA9ICJBQ1QiOw0KPiAtCQllbHNlIGlmIChrID09IGtl
eS5wZW5kaW5nKQ0KPiAtCQkJcyA9ICJQRU4iOw0KPiAtCQllbHNlDQo+IC0JCQlzID0gIi0iOw0K
PiArCQlpZiAoayA9PSBLRVlfTUFTVEVSKSB7DQo+ICsJCQlpZiAoaXNfcngoYykpDQo+ICsJCQkJ
Y29udGludWU7DQo+ICsJCQlpZiAodGltZV9iZWZvcmUoamlmZmllcywNCj4gKwkJCQkJYy0+dGlt
ZXIyICsgVElQQ19UWF9HUkFDRV9QRVJJT0QpKQ0KPiArCQkJCXMgPSAiQUNUIjsNCj4gKwkJCWVs
c2UNCj4gKwkJCQlzID0gIlBBUyI7DQo+ICsJCX0gZWxzZSB7DQo+ICsJCQlpZiAoayA9PSBrZXku
cGFzc2l2ZSkNCj4gKwkJCQlzID0gIlBBUyI7DQo+ICsJCQllbHNlIGlmIChrID09IGtleS5hY3Rp
dmUpDQo+ICsJCQkJcyA9ICJBQ1QiOw0KPiArCQkJZWxzZSBpZiAoayA9PSBrZXkucGVuZGluZykN
Cj4gKwkJCQlzID0gIlBFTiI7DQo+ICsJCQllbHNlDQo+ICsJCQkJcyA9ICItIjsNCj4gKwkJfQ0K
PiAgIAkJaSArPSBzY25wcmludGYoYnVmICsgaSwgMjAwIC0gaSwgIlx0S2V5JWQ6ICVzIiwgaywg
cyk7DQo+ICAgDQo+ICAgCQlyY3VfcmVhZF9sb2NrKCk7DQo+IGRpZmYgLS1naXQgYS9uZXQvdGlw
Yy9jcnlwdG8uaCBiL25ldC90aXBjL2NyeXB0by5oDQo+IGluZGV4IGMzZGU3NjlmNDllOC4uN2Zj
YjgwY2IwZThhIDEwMDY0NA0KPiAtLS0gYS9uZXQvdGlwYy9jcnlwdG8uaA0KPiArKysgYi9uZXQv
dGlwYy9jcnlwdG8uaA0KPiBAQCAtNzQsNyArNzQsNyBAQCBleHRlcm4gaW50IHN5c2N0bF90aXBj
X21heF90Zm1zIF9fcmVhZF9tb3N0bHk7DQo+ICAgICogICAgIDMgMyAyIDIgMiAyIDIgMiAyIDIg
MiAyIDEgMSAxIDEgMSAxIDEgMSAxIDEgMCAwIDAgMCAwIDAgMCAwIDAgMA0KPiAgICAqICAgICAx
IDAgOSA4IDcgNiA1IDR8MyAyIDEgMCA5IDggNyA2fDUgNCAzIDIgMSAwIDkgOHw3IDYgNSA0IDMg
MiAxIDANCj4gICAgKiAgICArLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSst
Ky0rLSstKy0rLSstKy0rLSstKy0rLSstKw0KPiAtICogdzA6fFZlcj03fCBVc2VyICB8RHxUWCB8
UlggfEt8ICAgICAgICAgICAgICAgICBSc3ZkICAgICAgICAgICAgICAgIHwNCj4gKyAqIHcwOnxW
ZXI9N3wgVXNlciAgfER8VFggfFJYIHxLfE18TnwgICAgICAgICAgICAgUnN2ZCAgICAgICAgICAg
ICAgICB8DQo+ICAgICogICAgKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0r
LSstKy0rLSstKy0rLSstKy0rLSstKy0rLSsNCj4gICAgKiB3MTp8ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBTZXFubyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KPiAgICAqIHcy
OnwgICAgICAgICAgICAgICAgICAgICAgICAgICAoOCBvY3RldHMpICAgICAgICAgICAgICAgICAg
ICAgICAgICB8DQo+IEBAIC0xMDEsNiArMTAxLDkgQEAgZXh0ZXJuIGludCBzeXNjdGxfdGlwY19t
YXhfdGZtcyBfX3JlYWRfbW9zdGx5Ow0KPiAgICAqCVJYCTogQ3VycmVudGx5IFJYIGFjdGl2ZSBr
ZXkgY29ycmVzcG9uZGluZyB0byB0aGUgZGVzdGluYXRpb24NCj4gICAgKgkgICAgICAgICAgbm9k
ZSdzIFRYIGtleSAod2hlbiB0aGUgIkQiIGJpdCBpcyBzZXQpDQo+ICAgICoJSwk6IEtlZXAtYWxp
dmUgYml0IChmb3IgUlBTLCBMSU5LX1BST1RPQ09ML1NUQVRFX01TRyBvbmx5KQ0KPiArICoJTSAg
ICAgICA6IEJpdCBpbmRpY2F0ZXMgaWYgc2VuZGVyIGhhcyBtYXN0ZXIga2V5DQo+ICsgKglOCTog
Qml0IGluZGljYXRlcyBpZiBzZW5kZXIgaGFzIG5vIFJYIGtleXMgY29ycmVzcG9uZGluZyB0byB0
aGUNCj4gKyAqCSAgICAgICAgICByZWNlaXZlcidzIFRYICh3aGVuIHRoZSAiRCIgYml0IGlzIHNl
dCkNCj4gICAgKglSc3ZkCTogUmVzZXJ2ZWQgYml0LCBmaWVsZA0KPiAgICAqIFdvcmQxLTI6DQo+
ICAgICoJU2Vxbm8JOiBUaGUgNjQtYml0IHNlcXVlbmNlIG51bWJlciBvZiB0aGUgZW5jcnlwdGVk
IG1lc3NhZ2UsIGFsc28NCj4gQEAgLTExNyw3ICsxMjAsOSBAQCBzdHJ1Y3QgdGlwY19laGRyIHsN
Cj4gICAJCQlfX3U4CWRlc3RpbmVkOjEsDQo+ICAgCQkJCXVzZXI6NCwNCj4gICAJCQkJdmVyc2lv
bjozOw0KPiAtCQkJX191OAlyZXNlcnZlZF8xOjMsDQo+ICsJCQlfX3U4CXJlc2VydmVkXzE6MSwN
Cj4gKwkJCQlyeF9ub2tleToxLA0KPiArCQkJCW1hc3Rlcl9rZXk6MSwNCj4gICAJCQkJa2VlcGFs
aXZlOjEsDQo+ICAgCQkJCXJ4X2tleV9hY3RpdmU6MiwNCj4gICAJCQkJdHhfa2V5OjI7DQo+IEBA
IC0xMjgsNyArMTMzLDkgQEAgc3RydWN0IHRpcGNfZWhkciB7DQo+ICAgCQkJX191OAl0eF9rZXk6
MiwNCj4gICAJCQkJcnhfa2V5X2FjdGl2ZToyLA0KPiAgIAkJCQlrZWVwYWxpdmU6MSwNCj4gLQkJ
CQlyZXNlcnZlZF8xOjM7DQo+ICsJCQkJbWFzdGVyX2tleToxLA0KPiArCQkJCXJ4X25va2V5OjEs
DQo+ICsJCQkJcmVzZXJ2ZWRfMToxOw0KPiAgICNlbHNlDQo+ICAgI2Vycm9yICAiUGxlYXNlIGZp
eCA8YXNtL2J5dGVvcmRlci5oPiINCj4gICAjZW5kaWYNCj4gQEAgLTE1OCw3ICsxNjUsNyBAQCBp
bnQgdGlwY19jcnlwdG9feG1pdChzdHJ1Y3QgbmV0ICpuZXQsIHN0cnVjdCBza19idWZmICoqc2ti
LA0KPiAgIGludCB0aXBjX2NyeXB0b19yY3Yoc3RydWN0IG5ldCAqbmV0LCBzdHJ1Y3QgdGlwY19j
cnlwdG8gKnJ4LA0KPiAgIAkJICAgIHN0cnVjdCBza19idWZmICoqc2tiLCBzdHJ1Y3QgdGlwY19i
ZWFyZXIgKmIpOw0KPiAgIGludCB0aXBjX2NyeXB0b19rZXlfaW5pdChzdHJ1Y3QgdGlwY19jcnlw
dG8gKmMsIHN0cnVjdCB0aXBjX2FlYWRfa2V5ICp1a2V5LA0KPiAtCQkJIHU4IG1vZGUpOw0KPiAr
CQkJIHU4IG1vZGUsIGJvb2wgbWFzdGVyX2tleSk7DQo+ICAgdm9pZCB0aXBjX2NyeXB0b19rZXlf
Zmx1c2goc3RydWN0IHRpcGNfY3J5cHRvICpjKTsNCj4gICBpbnQgdGlwY19hZWFkX2tleV92YWxp
ZGF0ZShzdHJ1Y3QgdGlwY19hZWFkX2tleSAqdWtleSk7DQo+ICAgYm9vbCB0aXBjX2VoZHJfdmFs
aWRhdGUoc3RydWN0IHNrX2J1ZmYgKnNrYik7DQo+IGRpZmYgLS1naXQgYS9uZXQvdGlwYy9tc2cu
aCBiL25ldC90aXBjL21zZy5oDQo+IGluZGV4IDEwMTZlOTZkYjVjNC4uMjVlNWM1YzhhNmZmIDEw
MDY0NA0KPiAtLS0gYS9uZXQvdGlwYy9tc2cuaA0KPiArKysgYi9uZXQvdGlwYy9tc2cuaA0KPiBA
QCAtMTI3LDcgKzEyNyw5IEBAIHN0cnVjdCB0aXBjX3NrYl9jYiB7DQo+ICAgI2lmZGVmIENPTkZJ
R19USVBDX0NSWVBUTw0KPiAgIAkJCXU4IGVuY3J5cHRlZDoxOw0KPiAgIAkJCXU4IGRlY3J5cHRl
ZDoxOw0KPiAtCQkJdTggcHJvYmU6MTsNCj4gKyNkZWZpbmUgU0tCX1BST0JJTkcJMQ0KPiArI2Rl
ZmluZSBTS0JfR1JBQ0lORwkyDQo+ICsJCQl1OCB4bWl0X3R5cGU6MjsNCj4gICAJCQl1OCB0eF9j
bG9uZV9kZWZlcnJlZDoxOw0KPiAgICNlbmRpZg0KPiAgIAkJfTsNCj4gZGlmZiAtLWdpdCBhL25l
dC90aXBjL25ldGxpbmsuYyBiL25ldC90aXBjL25ldGxpbmsuYw0KPiBpbmRleCBjNGFlZTYyNDdk
NTUuLjFlYzAwZmNjMjZlZSAxMDA2NDQNCj4gLS0tIGEvbmV0L3RpcGMvbmV0bGluay5jDQo+ICsr
KyBiL25ldC90aXBjL25ldGxpbmsuYw0KPiBAQCAtMTA4LDYgKzEwOCw3IEBAIGNvbnN0IHN0cnVj
dCBubGFfcG9saWN5IHRpcGNfbmxfbm9kZV9wb2xpY3lbVElQQ19OTEFfTk9ERV9NQVggKyAxXSA9
IHsNCj4gICAJCQkJCSAgICAubGVuID0gVElQQ19OT0RFSURfTEVOfSwNCj4gICAJW1RJUENfTkxB
X05PREVfS0VZXQkJPSB7IC50eXBlID0gTkxBX0JJTkFSWSwNCj4gICAJCQkJCSAgICAubGVuID0g
VElQQ19BRUFEX0tFWV9TSVpFX01BWH0sDQo+ICsJW1RJUENfTkxBX05PREVfS0VZX01BU1RFUl0J
PSB7IC50eXBlID0gTkxBX0ZMQUcgfSwNCj4gICB9Ow0KPiAgIA0KPiAgIC8qIFByb3BlcnRpZXMg
dmFsaWQgZm9yIG1lZGlhLCBiZWFyZXIgYW5kIGxpbmsgKi8NCj4gZGlmZiAtLWdpdCBhL25ldC90
aXBjL25vZGUuYyBiL25ldC90aXBjL25vZGUuYw0KPiBpbmRleCAwMzBhNTFjNGQxZmEuLjU1ZjAx
MmQxZWE3NCAxMDA2NDQNCj4gLS0tIGEvbmV0L3RpcGMvbm9kZS5jDQo+ICsrKyBiL25ldC90aXBj
L25vZGUuYw0KPiBAQCAtMjg3MiwxMSArMjg3MiwxMSBAQCBzdGF0aWMgaW50IF9fdGlwY19ubF9u
b2RlX3NldF9rZXkoc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IGdlbmxfaW5mbyAqaW5mbykN
Cj4gICB7DQo+ICAgCXN0cnVjdCBubGF0dHIgKmF0dHJzW1RJUENfTkxBX05PREVfTUFYICsgMV07
DQo+ICAgCXN0cnVjdCBuZXQgKm5ldCA9IHNvY2tfbmV0KHNrYi0+c2spOw0KPiAtCXN0cnVjdCB0
aXBjX25ldCAqdG4gPSB0aXBjX25ldChuZXQpOw0KPiArCXN0cnVjdCB0aXBjX2NyeXB0byAqdHgg
PSB0aXBjX25ldChuZXQpLT5jcnlwdG9fdHgsICpjID0gdHg7DQo+ICAgCXN0cnVjdCB0aXBjX25v
ZGUgKm4gPSBOVUxMOw0KPiAgIAlzdHJ1Y3QgdGlwY19hZWFkX2tleSAqdWtleTsNCj4gLQlzdHJ1
Y3QgdGlwY19jcnlwdG8gKmM7DQo+IC0JdTggKmlkLCAqb3duX2lkOw0KPiArCWJvb2wgbWFzdGVy
X2tleSA9IGZhbHNlOw0KPiArCXU4ICppZCwgKm93bl9pZCwgbW9kZTsNCj4gICAJaW50IHJjID0g
MDsNCj4gICANCj4gICAJaWYgKCFpbmZvLT5hdHRyc1tUSVBDX05MQV9OT0RFXSkNCj4gQEAgLTI4
ODYsNTEgKzI4ODYsNDUgQEAgc3RhdGljIGludCBfX3RpcGNfbmxfbm9kZV9zZXRfa2V5KHN0cnVj
dCBza19idWZmICpza2IsIHN0cnVjdCBnZW5sX2luZm8gKmluZm8pDQo+ICAgCQkJICAgICAgaW5m
by0+YXR0cnNbVElQQ19OTEFfTk9ERV0sDQo+ICAgCQkJICAgICAgdGlwY19ubF9ub2RlX3BvbGlj
eSwgaW5mby0+ZXh0YWNrKTsNCj4gICAJaWYgKHJjKQ0KPiAtCQlnb3RvIGV4aXQ7DQo+ICsJCXJl
dHVybiByYzsNCj4gICANCj4gICAJb3duX2lkID0gdGlwY19vd25faWQobmV0KTsNCj4gLQlpZiAo
IW93bl9pZCkgew0KPiAtCQlyYyA9IC1FUEVSTTsNCj4gLQkJZ290byBleGl0Ow0KPiAtCX0NCj4g
KwlpZiAoIW93bl9pZCkNCj4gKwkJcmV0dXJuIC1FUEVSTTsNCj4gICANCj4gICAJcmMgPSB0aXBj
X25sX3JldHJpZXZlX2tleShhdHRycywgJnVrZXkpOw0KPiAgIAlpZiAocmMpDQo+IC0JCWdvdG8g
ZXhpdDsNCj4gKwkJcmV0dXJuIHJjOw0KPiAgIA0KPiAgIAlyYyA9IHRpcGNfYWVhZF9rZXlfdmFs
aWRhdGUodWtleSk7DQo+ICAgCWlmIChyYykNCj4gLQkJZ290byBleGl0Ow0KPiArCQlyZXR1cm4g
cmM7DQo+ICAgDQo+ICAgCXJjID0gdGlwY19ubF9yZXRyaWV2ZV9ub2RlaWQoYXR0cnMsICZpZCk7
DQo+ICAgCXN3aXRjaCAocmMpIHsNCj4gICAJY2FzZSAtRU5PREFUQToNCj4gLQkJLyogQ2x1c3Rl
ciBrZXkgbW9kZSAqLw0KPiAtCQlyYyA9IHRpcGNfY3J5cHRvX2tleV9pbml0KHRuLT5jcnlwdG9f
dHgsIHVrZXksIENMVVNURVJfS0VZKTsNCj4gKwkJbW9kZSA9IENMVVNURVJfS0VZOw0KPiArCQlt
YXN0ZXJfa2V5ID0gISEoYXR0cnNbVElQQ19OTEFfTk9ERV9LRVlfTUFTVEVSXSk7DQo+ICAgCQli
cmVhazsNCj4gICAJY2FzZSAwOg0KPiAtCQkvKiBQZXItbm9kZSBrZXkgbW9kZSAqLw0KPiAtCQlp
ZiAoIW1lbWNtcChpZCwgb3duX2lkLCBOT0RFX0lEX0xFTikpIHsNCj4gLQkJCWMgPSB0bi0+Y3J5
cHRvX3R4Ow0KPiAtCQl9IGVsc2Ugew0KPiArCQltb2RlID0gUEVSX05PREVfS0VZOw0KPiArCQlp
ZiAobWVtY21wKGlkLCBvd25faWQsIE5PREVfSURfTEVOKSkgew0KPiAgIAkJCW4gPSB0aXBjX25v
ZGVfZmluZF9ieV9pZChuZXQsIGlkKSA/Og0KPiAgIAkJCQl0aXBjX25vZGVfY3JlYXRlKG5ldCwg
MCwgaWQsIDB4ZmZmZnUsIDAsIHRydWUpOw0KPiAtCQkJaWYgKHVubGlrZWx5KCFuKSkgew0KPiAt
CQkJCXJjID0gLUVOT01FTTsNCj4gLQkJCQlicmVhazsNCj4gLQkJCX0NCj4gKwkJCWlmICh1bmxp
a2VseSghbikpDQo+ICsJCQkJcmV0dXJuIC1FTk9NRU07DQo+ICAgCQkJYyA9IG4tPmNyeXB0b19y
eDsNCj4gICAJCX0NCj4gLQ0KPiAtCQlyYyA9IHRpcGNfY3J5cHRvX2tleV9pbml0KGMsIHVrZXks
IFBFUl9OT0RFX0tFWSk7DQo+IC0JCWlmIChuKQ0KPiAtCQkJdGlwY19ub2RlX3B1dChuKTsNCj4g
ICAJCWJyZWFrOw0KPiAgIAlkZWZhdWx0Og0KPiAtCQlicmVhazsNCj4gKwkJcmV0dXJuIHJjOw0K
PiAgIAl9DQo+ICAgDQo+IC1leGl0Og0KPiArCS8qIEluaXRpYXRlIHRoZSBUWC9SWCBrZXkgKi8N
Cj4gKwlyYyA9IHRpcGNfY3J5cHRvX2tleV9pbml0KGMsIHVrZXksIG1vZGUsIG1hc3Rlcl9rZXkp
Ow0KPiArCWlmIChuKQ0KPiArCQl0aXBjX25vZGVfcHV0KG4pOw0KPiArDQo+ICAgCXJldHVybiAo
cmMgPCAwKSA/IHJjIDogMDsNCj4gICB9DQo+ICAgDQpBY2tlZC1ieTogSm9uIE1hbG95IDxqbWFs
b3lAcmVkaGF0LmNvbT4NCg0KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCnRpcGMtZGlzY3Vzc2lvbiBtYWlsaW5nIGxpc3QKdGlwYy1kaXNjdXNzaW9uQGxp
c3RzLnNvdXJjZWZvcmdlLm5ldApodHRwczovL2xpc3RzLnNvdXJjZWZvcmdlLm5ldC9saXN0cy9s
aXN0aW5mby90aXBjLWRpc2N1c3Npb24K
